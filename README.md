#<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=iso-8859-1"/>
	<title></title>
	<meta name="generator" content="LibreOffice 6.3.2.2 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="00:00:00"/>
	<style type="text/css">
		@page { size: 8.27in 11.69in; margin: 1in }
		p { margin-bottom: 0.1in; direction: ltr; line-height: 115%; text-align: left; orphans: 2; widows: 2; background: transparent }
	</style>
</head>
<body link="#000080" vlink="#800000" dir="ltr"><p style="margin-bottom: 0in">
&lt;!DOCTYPE html&gt;</p>
<p style="margin-bottom: 0in">&lt;html lang=&quot;zh-TW&quot;&gt;</p>
<p style="margin-bottom: 0in">&lt;head&gt;</p>
<p style="margin-bottom: 0in">    &lt;meta charset=&quot;UTF-8&quot;&gt;</p>
<p style="margin-bottom: 0in">    &lt;meta name=&quot;viewport&quot;
content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</p>
<p style="margin-bottom: 0in">    <font face="Arial Unicode MS, serif">&lt;title&gt;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23431;&#23449;&#38675;&#34425;
</font></span></font><font face="Arial Unicode MS, serif">9x9 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20117;&#23383;&#36938;&#25138;
</font></span></font><font face="Arial Unicode MS, serif">- </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23431;&#23449;&#25136;&#22763;
</font></span></font><font face="Arial Unicode MS, serif">vs
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26997;&#38480;&#26143;&#22495;&#39764;&#29579;</font></span></font><font face="Arial Unicode MS, serif">&lt;/title&gt;</font></p>
<p style="margin-bottom: 0in">    &lt;script
src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;</p>
<p style="margin-bottom: 0in">    &lt;style&gt;</p>
<p style="margin-bottom: 0in">        /* Custom CSS for Game
Aesthetics - Cosmic Neon Theme */</p>
<p style="margin-bottom: 0in">        @import
url('https://fonts.fonts.googleapis.com/css2?family=Noto+Sans+TC:wght(700;900)&amp;display=swap');</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        body {</p>
<p style="margin-bottom: 0in">            font-family: 'Noto Sans
TC', sans-serif;</p>
<p style="margin-bottom: 0in">            background-color: #1a202c;
/* Deep space dark blue */</p>
<p style="margin-bottom: 0in">            display: flex;</p>
<p style="margin-bottom: 0in">            justify-content: center;</p>
<p style="margin-bottom: 0in">            align-items: center;</p>
<p style="margin-bottom: 0in">            min-height: 100vh;</p>
<p style="margin-bottom: 0in">            padding: 10px; 
</p>
<p style="margin-bottom: 0in">            color: #e2e8f0;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        .game-container {</p>
<p style="margin-bottom: 0in">            background-color: #2d3748;
/* Dark container */</p>
<p style="margin-bottom: 0in">            padding: 1.5rem; 
</p>
<p style="margin-bottom: 0in">            border-radius: 1.5rem;</p>
<p style="margin-bottom: 0in">            box-shadow: 0 20px 40px
rgba(0, 0, 0, 0.5), 0 0 20px rgba(74, 144, 226, 0.3);</p>
<p style="margin-bottom: 0in">            text-align: center;</p>
<p style="margin-bottom: 0in">            max-width: 90vw; 
</p>
<p style="margin-bottom: 0in">            max-height: 100vh;</p>
<p style="margin-bottom: 0in">            width: 650px; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /* Announcement Basket Style */</p>
<p style="margin-bottom: 0in">        #announcement-basket {</p>
<p style="margin-bottom: 0in">            background-color: #1f2937;
/* Darker background */</p>
<p style="margin-bottom: 0in">            padding: 0.75rem 1rem;</p>
<p style="margin-bottom: 0in">            border-radius: 0.75rem;</p>
<p style="margin-bottom: 0in">            margin-bottom: 1.5rem;</p>
<p style="margin-bottom: 0in">            border: 1px solid #4a5568;</p>
<p style="margin-bottom: 0in">            box-shadow: inset 0 0 5px
rgba(255, 255, 255, 0.1);</p>
<p style="margin-bottom: 0in">            text-align: center;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /* Dedicated Score Display Box
Styling */</p>
<p style="margin-bottom: 0in">        #score-display-box {</p>
<p style="margin-bottom: 0in">            display: flex;</p>
<p style="margin-bottom: 0in">            justify-content:
space-around;</p>
<p style="margin-bottom: 0in">            align-items: center;</p>
<p style="margin-bottom: 0in">            padding: 1rem;</p>
<p style="margin-bottom: 0in">            margin-bottom: 1.5rem;</p>
<p style="margin-bottom: 0in">            background-color: #1f2937;
/* Slightly lighter background */</p>
<p style="margin-bottom: 0in">            border-radius: 0.75rem;</p>
<p style="margin-bottom: 0in">            /* Default: Neon Red/Pink
Border for Demon King theme (PvC) */</p>
<p style="margin-bottom: 0in">            border: 2px solid #ff3366; 
</p>
<p style="margin-bottom: 0in">            box-shadow: 0 0 15px
rgba(255, 51, 102, 0.5); /* Neon glow effect */</p>
<p style="margin-bottom: 0in">            transition: border-color
0.5s, box-shadow 0.5s; /* Smooth transition */</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /* PvP Blue Border for Score
Display */</p>
<p style="margin-bottom: 0in">       
#score-display-box.pvp-blue-border {</p>
<p style="margin-bottom: 0in">            border-color: #00ccff
!important;</p>
<p style="margin-bottom: 0in">            box-shadow: 0 0 15px
rgba(0, 204, 255, 0.7) !important; /* Blue glow */</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        .score-segment {</p>
<p style="margin-bottom: 0in">            display: flex;</p>
<p style="margin-bottom: 0in">            flex-direction: column;</p>
<p style="margin-bottom: 0in">            align-items: center;</p>
<p style="margin-bottom: 0in">            padding: 0 1rem;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        .score-value {</p>
<p style="margin-bottom: 0in">            font-size: 2.5rem;</p>
<p style="margin-bottom: 0in">            font-weight: 900;</p>
<p style="margin-bottom: 0in">            line-height: 1;</p>
<p style="margin-bottom: 0in">            margin-top: 0.25rem;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        .score-separator {</p>
<p style="margin-bottom: 0in">            font-size: 2.5rem;</p>
<p style="margin-bottom: 0in">            font-weight: 900;</p>
<p style="margin-bottom: 0in">            color: #4a5568;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        .board {</p>
<p style="margin-bottom: 0in">            display: grid;</p>
<p style="margin-bottom: 0in">            grid-template-columns:
repeat(9, 1fr); /* 9x9 Grid */</p>
<p style="margin-bottom: 0in">            grid-template-rows:
repeat(9, 1fr); /* 9x9 Grid */</p>
<p style="margin-bottom: 0in">            gap: 4px; 
</p>
<p style="margin-bottom: 0in">            margin: 1.5rem auto;</p>
<p style="margin-bottom: 0in">            /* Default: Neon Red grid
border for PvC (Demon King) */</p>
<p style="margin-bottom: 0in">            border: 6px solid #ff3366; 
</p>
<p style="margin-bottom: 0in">            border-radius: 12px;</p>
<p style="margin-bottom: 0in">            overflow: hidden;</p>
<p style="margin-bottom: 0in">            background-color: #ff3366;</p>
<p style="margin-bottom: 0in">            box-shadow: 0 0 20px
rgba(255, 51, 102, 0.5);</p>
<p style="margin-bottom: 0in">            aspect-ratio: 1 / 1; 
</p>
<p style="margin-bottom: 0in">            width: 100%;</p>
<p style="margin-bottom: 0in">            transition: border-color
0.5s, background-color 0.5s, box-shadow 0.5s; /* Smooth transition */</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /* PvP Blue Border for Space
Warrior Mode */</p>
<p style="margin-bottom: 0in">        .board.pvp-blue-border {</p>
<p style="margin-bottom: 0in">            border-color: #00ccff
!important;</p>
<p style="margin-bottom: 0in">            background-color: #00ccff
!important;</p>
<p style="margin-bottom: 0in">            box-shadow: 0 0 20px
rgba(0, 204, 255, 0.7) !important; /* Blue glow */</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        .cell {</p>
<p style="margin-bottom: 0in">            background-color: #4a5568;
/* Dark cell background */</p>
<p style="margin-bottom: 0in">            min-width: 0; 
</p>
<p style="margin-bottom: 0in">            min-height: 0;</p>
<p style="margin-bottom: 0in">            display: flex;</p>
<p style="margin-bottom: 0in">            justify-content: center;</p>
<p style="margin-bottom: 0in">            align-items: center;</p>
<p style="margin-bottom: 0in">            font-size: 1.8rem; 
</p>
<p style="margin-bottom: 0in">            font-weight: 900;</p>
<p style="margin-bottom: 0in">            cursor: pointer;</p>
<p style="margin-bottom: 0in">            transition:
background-color 0.2s, transform 0.1s;</p>
<p style="margin-bottom: 0in">            user-select: none;</p>
<p style="margin-bottom: 0in">            border-radius: 4px;</p>
<p style="margin-bottom: 0in">            box-shadow: inset 0 0 3px
rgba(0, 0, 0, 0.2);</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /* Update hover exclusion list
to include all 9 pieces */</p>
<p style="margin-bottom: 0in">       
.cell:hover:not([class*=&quot;ufo&quot;]):not([class*=&quot;satellite&quot;]):not([class*=&quot;monster&quot;]):not([class*=&quot;rocket&quot;]):not([class*=&quot;star&quot;]):not([class*=&quot;comet&quot;]):not([class*=&quot;robot&quot;]):not([class*=&quot;nebula&quot;]):not([class*=&quot;galaxy&quot;])
{ 
</p>
<p style="margin-bottom: 0in">            background-color: #2d3748;
/* Darker hover */</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /* Interactive Pop Effect
(temporary class added by JS) */</p>
<p style="margin-bottom: 0in">        .pop-effect {</p>
<p style="margin-bottom: 0in">            transform: scale(1.15);</p>
<p style="margin-bottom: 0in">            transition: transform 0.1s
ease-out;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /*
-------------------------------------- */</p>
<p style="margin-bottom: 0in">        /* --- SYMBOLS AND COOLER
EFFECTS --- */</p>
<p style="margin-bottom: 0in">        /*
-------------------------------------- */</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
UFO (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20405;&#30053;&#32773;
</font></span></font><font face="Arial Unicode MS, serif">- Neon
Red/Pink) */</font></p>
<p style="margin-bottom: 0in">        .cell.ufo {</p>
<p style="margin-bottom: 0in">            text-shadow: 0 0 8px
#ff3366, 0 0 16px #ff3366; 
</p>
<p style="margin-bottom: 0in">            filter: drop-shadow(0 0 8px
#ff3366); 
</p>
<p style="margin-bottom: 0in">            font-size: 2.2rem; 
</p>
<p style="margin-bottom: 0in">            animation: symbol-pulse
1.5s infinite alternate; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
Satellite (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38450;&#31142;&#22612;
</font></span></font><font face="Arial Unicode MS, serif">- Neon
Cyan/Blue) */</font></p>
<p style="margin-bottom: 0in">        .cell.satellite {</p>
<p style="margin-bottom: 0in">            text-shadow: 0 0 8px
#00ccff, 0 0 16px #00ccff; 
</p>
<p style="margin-bottom: 0in">            filter: drop-shadow(0 0 8px
#00ccff); 
</p>
<p style="margin-bottom: 0in">            font-size: 2.2rem; 
</p>
<p style="margin-bottom: 0in">            animation: symbol-pulse
1.5s infinite alternate; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
Monster (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26143;&#38555;&#24618;&#29560;
</font></span></font><font face="Arial Unicode MS, serif">- Neon
Green) */</font></p>
<p style="margin-bottom: 0in">        .cell.monster {</p>
<p style="margin-bottom: 0in">            text-shadow: 0 0 8px
#39ff14, 0 0 16px #39ff14; 
</p>
<p style="margin-bottom: 0in">            filter: drop-shadow(0 0 8px
#39ff14); 
</p>
<p style="margin-bottom: 0in">            font-size: 2.2rem; 
</p>
<p style="margin-bottom: 0in">            animation: symbol-pulse
1.5s infinite alternate; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
Rocket (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37504;&#27827;&#28779;&#31661;
</font></span></font><font face="Arial Unicode MS, serif">- Neon
Purple) */</font></p>
<p style="margin-bottom: 0in">        .cell.rocket {</p>
<p style="margin-bottom: 0in">            text-shadow: 0 0 8px
#bf00ff, 0 0 16px #bf00ff; 
</p>
<p style="margin-bottom: 0in">            filter: drop-shadow(0 0 8px
#bf00ff); 
</p>
<p style="margin-bottom: 0in">            font-size: 2.2rem; 
</p>
<p style="margin-bottom: 0in">            animation: symbol-pulse
1.5s infinite alternate; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
Star (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38275;&#32768;&#20043;&#26143;
</font></span></font><font face="Arial Unicode MS, serif">- Neon
Yellow/Gold) */</font></p>
<p style="margin-bottom: 0in">        .cell.star {</p>
<p style="margin-bottom: 0in">            text-shadow: 0 0 8px
#ffd700, 0 0 16px #ffd700; 
</p>
<p style="margin-bottom: 0in">            filter: drop-shadow(0 0 8px
#ffd700); 
</p>
<p style="margin-bottom: 0in">            font-size: 2.2rem; 
</p>
<p style="margin-bottom: 0in">            animation: symbol-pulse
1.5s infinite alternate; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
Comet (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24407;&#26143;
</font></span></font><font face="Arial Unicode MS, serif">- Neon
Orange) */</font></p>
<p style="margin-bottom: 0in">        .cell.comet {</p>
<p style="margin-bottom: 0in">            text-shadow: 0 0 8px
#ff8c00, 0 0 16px #ff8c00; 
</p>
<p style="margin-bottom: 0in">            filter: drop-shadow(0 0 8px
#ff8c00); 
</p>
<p style="margin-bottom: 0in">            font-size: 2.2rem; 
</p>
<p style="margin-bottom: 0in">            animation: symbol-pulse
1.5s infinite alternate; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
NEW: Robot (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37504;&#27827;&#27231;&#22120;&#20154;
</font></span></font><font face="Arial Unicode MS, serif">-
White/Silver) */</font></p>
<p style="margin-bottom: 0in">        .cell.robot {</p>
<p style="margin-bottom: 0in">            text-shadow: 0 0 8px
#ffffff, 0 0 16px #ffffff; 
</p>
<p style="margin-bottom: 0in">            filter: drop-shadow(0 0 8px
#ffffff); 
</p>
<p style="margin-bottom: 0in">            font-size: 2.2rem; 
</p>
<p style="margin-bottom: 0in">            animation: symbol-pulse
1.5s infinite alternate; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
NEW: Nebula (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24187;&#24433;&#26143;&#38642;
</font></span></font><font face="Arial Unicode MS, serif">- Cyan) */</font></p>
<p style="margin-bottom: 0in">        .cell.nebula {</p>
<p style="margin-bottom: 0in">            text-shadow: 0 0 8px
#00ffff, 0 0 16px #00ffff; 
</p>
<p style="margin-bottom: 0in">            filter: drop-shadow(0 0 8px
#00ffff); 
</p>
<p style="margin-bottom: 0in">            font-size: 2.2rem; 
</p>
<p style="margin-bottom: 0in">            animation: symbol-pulse
1.5s infinite alternate; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
NEW: Galaxy (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38275;&#32768;&#37504;&#27827;
</font></span></font><font face="Arial Unicode MS, serif">- Hot Pink)
*/</font></p>
<p style="margin-bottom: 0in">        .cell.galaxy {</p>
<p style="margin-bottom: 0in">            text-shadow: 0 0 8px
#ff69b4, 0 0 16px #ff69b4; 
</p>
<p style="margin-bottom: 0in">            filter: drop-shadow(0 0 8px
#ff69b4); 
</p>
<p style="margin-bottom: 0in">            font-size: 2.2rem; 
</p>
<p style="margin-bottom: 0in">            animation: symbol-pulse
1.5s infinite alternate; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /* Symbol Pulse Animation for
&quot;Live&quot; Pieces */</p>
<p style="margin-bottom: 0in">        @keyframes symbol-pulse {</p>
<p style="margin-bottom: 0in">            from { opacity: 0.9;
transform: scale(1); }</p>
<p style="margin-bottom: 0in">            to { opacity: 1; transform:
scale(1.03); }</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        .cell.win {</p>
<p style="margin-bottom: 0in">            background-color: #f6e05e
!important; /* Bright Neon Yellow highlight */</p>
<p style="margin-bottom: 0in">            color: #2d3748 !important;
/* Dark text on bright background */</p>
<p style="margin-bottom: 0in">            box-shadow: 0 0 15px
#f6e05e, 0 0 30px #f6e05e; /* Intense glow */</p>
<p style="margin-bottom: 0in">            animation: win-pulse 0.4s
infinite alternate;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        @keyframes win-pulse {</p>
<p style="margin-bottom: 0in">            from { opacity: 0.8;
transform: scale(1); }</p>
<p style="margin-bottom: 0in">            to { opacity: 1; transform:
scale(1.05); }</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        #status {</p>
<p style="margin-bottom: 0in">            font-size: 1.5rem;</p>
<p style="margin-bottom: 0in">            font-weight: 700;</p>
<p style="margin-bottom: 0in">            margin-bottom: 1rem;</p>
<p style="margin-bottom: 0in">            min-height: 35px;</p>
<p style="margin-bottom: 0in">            text-shadow: 0 0 5px
rgba(255, 255, 255, 0.2);</p>
<p style="margin-bottom: 0in">            line-height: 1.2; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /* Current Round Progress
Display */</p>
<p style="margin-bottom: 0in">        #status .score-progress-display
{</p>
<p style="margin-bottom: 0in">            font-size: 0.9rem;</p>
<p style="margin-bottom: 0in">            margin-top: 5px;</p>
<p style="margin-bottom: 0in">            display: block;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        .game-button {</p>
<p style="margin-bottom: 0in">            padding: 0.8rem 1.5rem; /*
Adjusted for flex-1 */</p>
<p style="margin-bottom: 0in">            font-size: 1.3rem;</p>
<p style="margin-bottom: 0in">            font-weight: 700;</p>
<p style="margin-bottom: 0in">            border: none;</p>
<p style="margin-bottom: 0in">            border-radius: 50px;</p>
<p style="margin-bottom: 0in">            cursor: pointer;</p>
<p style="margin-bottom: 0in">            box-shadow: 0 4px 15px
rgba(0, 0, 0, 0.4);</p>
<p style="margin-bottom: 0in">            transition: transform 0.1s,
box-shadow 0.1s, background 0.3s;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /* Primary Reset Button Style
*/</p>
<p style="margin-bottom: 0in">        #reset-button {</p>
<p style="margin-bottom: 0in">            background:
linear-gradient(135deg, #ff3366, #bf00ff); /* Demon theme gradient */</p>
<p style="margin-bottom: 0in">            color: #1a202c;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        #reset-button:hover {</p>
<p style="margin-bottom: 0in">            transform:
translateY(-3px);</p>
<p style="margin-bottom: 0in">            box-shadow: 0 8px 25px
rgba(0, 0, 0, 0.5), 0 0 15px #ff3366;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /* Secondary End Round Button
Style */</p>
<p style="margin-bottom: 0in">        #end-round-button {</p>
<p style="margin-bottom: 0in">            background: #4a5568; /*
Darker secondary color */</p>
<p style="margin-bottom: 0in">            color: #a0aec0; /* Lighter
gray text */</p>
<p style="margin-bottom: 0in">            box-shadow: 0 2px 10px
rgba(0, 0, 0, 0.3);</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">       
#end-round-button:hover:not(:disabled) {</p>
<p style="margin-bottom: 0in">            transform:
translateY(-3px);</p>
<p style="margin-bottom: 0in">            background: #ff3366; /*
Neon Red on hover */</p>
<p style="margin-bottom: 0in">            color: #1a202c;</p>
<p style="margin-bottom: 0in">            box-shadow: 0 8px 25px
rgba(0, 0, 0, 0.5), 0 0 15px #ff3366;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /* Disabled Button Style */</p>
<p style="margin-bottom: 0in">        #end-round-button:disabled {</p>
<p style="margin-bottom: 0in">            background: #5a6268
!important; 
</p>
<p style="margin-bottom: 0in">            color: #c4c8cd !important;</p>
<p style="margin-bottom: 0in">            cursor: not-allowed
!important;</p>
<p style="margin-bottom: 0in">            box-shadow: none
!important;</p>
<p style="margin-bottom: 0in">            transform: none !important;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /* --- NEW: Fixed Selector
Style for Demon King --- */</p>
<p style="margin-bottom: 0in">        #p2-theme:disabled {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">appearance:
none; /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31227;&#38500;&#19979;&#25289;&#31661;&#38957;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">            -webkit-appearance: none;</p>
<p style="margin-bottom: 0in">            -moz-appearance: none;</p>
<p style="margin-bottom: 0in">            cursor: default !important;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">background-color:
#3f4756 !important; /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#28145;&#33394;&#32972;&#26223;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">/*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#39764;&#29579;&#36557;&#22296;&#30340;&#38928;&#35373;&#31526;&#34399;&#38991;&#33394;&#35373;&#32622;&#37002;&#26694;&#21644;&#25991;&#23383;&#38991;&#33394;
</font></span></font><font face="Arial Unicode MS, serif">(PvC</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24335;&#19979;&#36890;&#24120;&#26159;</font></span></font><font face="Arial Unicode MS, serif">SATELLITE</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#34253;&#33394;&#25110;</font></span></font><font face="Arial Unicode MS, serif">MONSTER</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#32160;&#33394;</font></span></font><font face="Arial Unicode MS, serif">)
*/</font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">border:
2px solid #39ff14; /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38928;&#35373;
</font></span></font><font face="Arial Unicode MS, serif">MONSTER </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#32160;&#33394;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">            color: #39ff14 !important; 
</p>
<p style="margin-bottom: 0in">            font-weight: 900;</p>
<p style="margin-bottom: 0in">            text-align: center;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">padding-right:
12px; /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22686;&#21152;&#21491;&#37002;&#38291;&#36317;&#20358;&#21462;&#20195;&#19979;&#25289;&#31661;&#38957;&#30340;&#31354;&#38291;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /* --- Celebration Modal Styles
--- */</p>
<p style="margin-bottom: 0in">        #celebration-modal {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">/*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38928;&#35373;&#38577;&#34255;&#20006;&#20308;&#28415;&#20840;&#23631;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">            opacity: 0;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">pointer-events:
none; /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35731;&#40670;&#25802;&#31359;&#36879;&#65292;&#30452;&#21040;&#39023;&#31034;&#26178;&#25165;&#21855;&#29992;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">            transition: opacity 0.5s
ease-out;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        #celebration-modal.modal-show {</p>
<p style="margin-bottom: 0in">            opacity: 1;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">pointer-events:
auto; /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#26178;&#21855;&#29992;&#40670;&#25802;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24907;&#26694;&#20839;&#23481;&#30340;&#21205;&#30059;&#25928;&#26524;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">        #modal-content {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">background-color:
#1f2937; /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#28145;&#34253;&#33394;&#32972;&#26223;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">border:
4px solid; /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37002;&#26694;&#38991;&#33394;&#23559;&#30001;
</font></span></font><font face="Arial Unicode MS, serif">JS </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35373;&#32622;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">transform:
scale(0.8); /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21021;&#22987;&#32302;&#23567;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">opacity:
0; /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21021;&#22987;&#36879;&#26126;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">box-shadow:
0 0 50px rgba(0, 0, 0, 0.7); /* </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22823;&#38512;&#24433;
</font></span></font><font face="Arial Unicode MS, serif">*/</font></p>
<p style="margin-bottom: 0in">            animation: modal-bg-pulse
3s infinite alternate;</p>
<p style="margin-bottom: 0in">            transition: transform 0.5s
cubic-bezier(0.175, 0.885, 0.32, 1.27), opacity 0.3s;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        #celebration-modal.modal-show
#modal-content {</p>
<p style="margin-bottom: 0in">            transform: scale(1);</p>
<p style="margin-bottom: 0in">            opacity: 1;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        @keyframes modal-bg-pulse {</p>
<p style="margin-bottom: 0in">            from { box-shadow: 0 0 20px
#2d3748; }</p>
<p style="margin-bottom: 0in">            to { box-shadow: 0 0 40px
#ff336660; }</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">/*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38911;&#25033;&#24335;&#35519;&#25972;
</font></span></font><font face="Arial Unicode MS, serif">for mobile
*/</font></p>
<p style="margin-bottom: 0in">        @media (max-width: 650px) {</p>
<p style="margin-bottom: 0in">            .game-container {</p>
<p style="margin-bottom: 0in">                max-width: 100%;</p>
<p style="margin-bottom: 0in">                padding: 1rem;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            .cell {</p>
<p style="margin-bottom: 0in">                font-size: 1.5rem;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            #status {</p>
<p style="margin-bottom: 0in">                font-size: 1.2rem;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            .selection-controls {</p>
<p style="margin-bottom: 0in">                flex-direction: column;</p>
<p style="margin-bottom: 0in">                gap: 1rem;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            #score-display-box {</p>
<p style="margin-bottom: 0in">                padding: 0.75rem;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            .score-value {</p>
<p style="margin-bottom: 0in">                font-size: 2rem;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            .score-segment span {</p>
<p style="margin-bottom: 0in">                font-size: 0.8rem;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            #modal-title {</p>
<p style="margin-bottom: 0in">                font-size: 2.5rem;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            #modal-message {</p>
<p style="margin-bottom: 0in">                font-size: 1rem;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            #announcement-basket {</p>
<p style="margin-bottom: 0in">                padding: 0.5rem;</p>
<p style="margin-bottom: 0in">                margin-bottom: 1rem;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">    &lt;/style&gt;</p>
<p style="margin-bottom: 0in">&lt;/head&gt;</p>
<p style="margin-bottom: 0in">&lt;body&gt;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">    &lt;div class=&quot;game-container&quot;&gt;</p>
<p style="margin-bottom: 0in">        &lt;h1 class=&quot;text-3xl
font-extrabold mb-4 text-white&quot;&gt;&#127756; <font face="Arial"><span lang="zh-CN">&#23431;&#23449;&#25136;&#22763;
</span></font>vs <font face="Arial"><span lang="zh-CN">&#26997;&#38480;&#26143;&#22495;&#39764;&#29579;
</span></font>9x9 <font face="Arial"><span lang="zh-CN">&#20117;&#23383;&#36938;&#25138;
&#128520;</span></font>&lt;/h1&gt;</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">&lt;!--
--- </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23431;&#23449;&#24773;&#22577;&#20844;&#21578;&#31811;
</font></span></font><font face="Arial Unicode MS, serif">--- --&gt;</font></p>
<p style="margin-bottom: 0in">        &lt;div
id=&quot;announcement-basket&quot;&gt;</p>
<p style="margin-bottom: 0in">            &lt;p class=&quot;text-sm
font-semibold text-gray-300&quot;&gt;</p>
<p style="margin-bottom: 0in">                &#128227; &lt;span
class=&quot;text-[#39ff14]&quot;&gt;<font face="Arial"><span lang="zh-CN">&#26368;&#26032;&#24773;&#22577;</span></font>:&lt;/span&gt;
<font face="Arial"><span lang="zh-CN">&#39764;&#29579;&#36557;&#22296;&#24050;&#25505;&#29992;&#38263;&#36899;&#31105;&#35336;&#20998;&#27861;&#21063;&#65292;&#25152;&#26377;&#36899;&#32218;&#24517;&#38920;</span></font>**<font face="Arial"><span lang="zh-CN">&#21083;&#22909;
</span></font>5 <font face="Arial"><span lang="zh-CN">&#20491;</span></font>**<font face="Arial"><span lang="zh-CN">&#25165;&#33021;&#35336;&#20998;&#65281;</span></font></p>
<p style="margin-bottom: 0in">            &lt;/p&gt;</p>
<p style="margin-bottom: 0in">        &lt;/div&gt;</p>
<p style="margin-bottom: 0in">        &lt;!-- -----------------------
--&gt;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">&lt;!--
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35215;&#21063;&#35498;&#26126;&#65306;&#24050;&#26356;&#26032;&#38263;&#36899;&#31105;&#35336;&#20998;&#30340;&#35215;&#21063;
</font></span></font><font face="Arial Unicode MS, serif">--&gt;</font></p>
<p style="margin-bottom: 0in">        &lt;p class=&quot;text-xl
font-bold text-[#ffd700] mb-2&quot;&gt;&#11088; <font face="Arial"><span lang="zh-CN">&#23565;&#27770;&#30446;&#27161;&#65306;&#29575;&#20808;&#29554;&#24471;
</span></font>**3 <font face="Arial"><span lang="zh-CN">&#20998;</span></font>**
<font face="Arial"><span lang="zh-CN">&#30340;&#19968;&#26041;&#65292;&#23559;&#36111;&#24471;&#25972;&#20491;&#25136;&#24441;&#65281;</span></font>&lt;/p&gt;</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">&lt;p
class=&quot;text-gray-400 mb-6&quot;&gt;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22238;&#21512;&#21213;&#21033;&#26781;&#20214;&#65306;&#21934;&#22238;&#21512;&#20013;&#29575;&#20808;&#25214;&#21040;
</font></span></font><font face="Arial Unicode MS, serif">**4**
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;</font></span></font><font face="Arial Unicode MS, serif">**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21083;&#22909;</font></span></font><font face="Arial Unicode MS, serif">**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36899;&#25104;
</font></span></font><font face="Arial Unicode MS, serif">5
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20491;&#31526;&#34399;&#30340;&#32218;&#65292;&#36111;&#24471;&#26412;&#22238;&#21512;&#30340;
</font></span></font><font face="Arial Unicode MS, serif">**1
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20998;</font></span></font><font face="Arial Unicode MS, serif">**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65281;</font></span></font><font face="Arial Unicode MS, serif">&lt;/p&gt;</font></p>
<p style="margin-bottom: 0in">        &lt;p class=&quot;text-xs
text-yellow-300 mb-4&quot;&gt;&#9888;&#65039; **<font face="Arial"><span lang="zh-CN">&#39764;&#29579;&#27861;&#21063;&#65306;</span></font>**
<font face="Arial"><span lang="zh-CN">&#36899;&#32218;&#36229;&#36942;
</span></font>5 <font face="Arial"><span lang="zh-CN">&#20491;
</span></font>(<font face="Arial"><span lang="zh-CN">&#38263;&#36899;</span></font>/Overline)
<font face="Arial"><span lang="zh-CN">&#23559; </span></font>**<font face="Arial"><span lang="zh-CN">&#19981;&#35336;&#20998;</span></font>**<font face="Arial"><span lang="zh-CN">&#65281;</span></font>&lt;/p&gt;</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        &lt;!-- Total Match Score
Display --&gt;</p>
<p style="margin-bottom: 0in">        &lt;div id=&quot;score-display-box&quot;&gt;</p>
<p style="margin-bottom: 0in">            &lt;!-- Content will be
injected by renderMatchScores() --&gt;</p>
<p style="margin-bottom: 0in">        &lt;/div&gt;</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">&lt;!--
Game Mode Selection (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36938;&#25138;&#27169;&#24335;&#36984;&#25799;</font></span></font><font face="Arial Unicode MS, serif">)
--&gt;</font></p>
<p style="margin-bottom: 0in">        &lt;div class=&quot;flex
items-center space-x-4 justify-center mb-6&quot;&gt;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">&lt;label
for=&quot;game-mode&quot; class=&quot;text-white font-semibold
whitespace-nowrap&quot;&gt;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25136;&#39717;&#27169;&#24335;</font></span></font><font face="Arial Unicode MS, serif">:&lt;/label&gt;</font></p>
<p style="margin-bottom: 0in">            &lt;select id=&quot;game-mode&quot;
class=&quot;bg-gray-700 text-white p-2 rounded-lg cursor-pointer
transition-all&quot;&gt;</p>
<p style="margin-bottom: 0in">                &lt;option
value=&quot;PVP&quot;&gt;&#128100; <font face="Arial"><span lang="zh-CN">&#23431;&#23449;&#25136;&#22763;
</span></font>vs <font face="Arial"><span lang="zh-CN">&#23431;&#23449;&#25136;&#22763;
</span></font>(PvP)&lt;/option&gt;</p>
<p style="margin-bottom: 0in">                &lt;option
value=&quot;PVC&quot;&gt;&#128520; <font face="Arial"><span lang="zh-CN">&#23431;&#23449;&#25136;&#22763;
</span></font>vs <font face="Arial"><span lang="zh-CN">&#39764;&#29579;
</span></font>(PvC)&lt;/option&gt;</p>
<p style="margin-bottom: 0in">            &lt;/select&gt;</p>
<p style="margin-bottom: 0in">        &lt;/div&gt;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">&lt;!--
Difficulty Selector (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38627;&#24230;&#36984;&#25799;&#22120;</font></span></font><font face="Arial Unicode MS, serif">)
- NOW DEMON KING LEVELS --&gt;</font></p>
<p style="margin-bottom: 0in">        &lt;div id=&quot;difficulty-control&quot;
class=&quot;flex items-center space-x-4 justify-center mb-6 hidden&quot;&gt;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">&lt;label
for=&quot;difficulty&quot; class=&quot;text-white font-semibold
whitespace-nowrap&quot;&gt;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39764;&#29579;&#38627;&#24230;</font></span></font><font face="Arial Unicode MS, serif">:&lt;/label&gt;</font></p>
<p style="margin-bottom: 0in">            &lt;select id=&quot;difficulty&quot;
class=&quot;bg-gray-700 text-white p-2 rounded-lg cursor-pointer
transition-all&quot;&gt;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">&lt;option
value=&quot;simple&quot;&gt;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20365;&#34907;&#32026;
</font></span></font><font face="Arial Unicode MS, serif">(Simple)&lt;/option&gt;</font></p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">&lt;option
value=&quot;normal&quot;&gt;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23559;&#36557;&#32026;
</font></span></font><font face="Arial Unicode MS, serif">(Normal)&lt;/option&gt;</font></p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">&lt;option
value=&quot;difficult&quot;&gt;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22823;&#39764;&#23566;&#24107;&#32026;
</font></span></font><font face="Arial Unicode MS, serif">(Difficult)&lt;/option&gt;</font></p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">&lt;option
value=&quot;hell&quot; selected&gt;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26997;&#38480;&#39764;&#29579;&#32026;
</font></span></font><font face="Arial Unicode MS, serif">(The Demon
King)&lt;/option&gt;</font></p>
<p style="margin-bottom: 0in">            &lt;/select&gt;</p>
<p style="margin-bottom: 0in">        &lt;/div&gt;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">&lt;!--
Theme Selection Controls (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20027;&#38988;&#36984;&#25799;&#25511;&#21046;&#38917;</font></span></font><font face="Arial Unicode MS, serif">)
--&gt;</font></p>
<p style="margin-bottom: 0in">        &lt;div id=&quot;theme-controls&quot;
class=&quot;selection-controls flex flex-col md:flex-row
justify-center space-y-4 md:space-y-0 md:space-x-8 mb-6&quot;&gt;</p>
<p style="margin-bottom: 0in">            &lt;div class=&quot;flex
items-center space-x-2 justify-center&quot;&gt;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">&lt;label
for=&quot;p1-theme&quot; class=&quot;text-white font-semibold
whitespace-nowrap&quot;&gt;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23431;&#23449;&#25136;&#22763;
</font></span></font><font face="Arial Unicode MS, serif">1
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#34399;</font></span></font><font face="Arial Unicode MS, serif">:&lt;/label&gt;</font></p>
<p style="margin-bottom: 0in">                &lt;select
id=&quot;p1-theme&quot; class=&quot;bg-gray-700 text-white p-2
rounded-lg cursor-pointer transition-all&quot;&gt;&lt;/select&gt;</p>
<p style="margin-bottom: 0in">            &lt;/div&gt;</p>
<p style="margin-bottom: 0in">            &lt;div class=&quot;flex
items-center space-x-2 justify-center&quot;&gt;</p>
<p style="margin-bottom: 0in">                &lt;label id=&quot;p2-label&quot;
for=&quot;p2-theme&quot; class=&quot;text-white font-semibold
whitespace-nowrap&quot;&gt;&#128520; <font face="Arial"><span lang="zh-CN">&#39764;&#29579;
</span></font>(<font face="Arial"><span lang="zh-CN">&#24460;&#25163;</span></font>):&lt;/label&gt;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">&lt;!--
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30070;&#22312;
</font></span></font><font face="Arial Unicode MS, serif">PVC </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24335;&#19979;&#65292;&#27492;
</font></span></font><font face="Arial Unicode MS, serif">Select
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26371;&#34987;&#31105;&#29992;&#65292;&#20006;&#25033;&#29992;&#29305;&#27530;&#30340;
</font></span></font><font face="Arial Unicode MS, serif">CSS
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27171;&#24335;&#20351;&#20854;&#30475;&#36215;&#20358;&#20687;&#22266;&#23450;&#24509;&#31456;
</font></span></font><font face="Arial Unicode MS, serif">--&gt;</font></p>
<p style="margin-bottom: 0in">                &lt;select
id=&quot;p2-theme&quot; class=&quot;bg-gray-700 text-white p-2
rounded-lg cursor-pointer transition-all&quot;&gt;&lt;/select&gt;</p>
<p style="margin-bottom: 0in">            &lt;/div&gt;</p>
<p style="margin-bottom: 0in">        &lt;/div&gt;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        &lt;div id=&quot;status&quot;&gt;&lt;/div&gt;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        &lt;div id=&quot;board&quot;
class=&quot;board&quot;&gt;</p>
<p style="margin-bottom: 0in">            &lt;!-- Cells will be
generated by JavaScript --&gt;</p>
<p style="margin-bottom: 0in">        &lt;/div&gt;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">&lt;!--
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26032;&#22686;&#30340;&#25353;&#37397;&#23481;&#22120;
</font></span></font><font face="Arial Unicode MS, serif">--&gt;</font></p>
<p style="margin-bottom: 0in">        &lt;div class=&quot;flex
flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4
justify-center mt-6&quot;&gt;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">&lt;!--
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#40670;&#25802;&#27492;&#25353;&#37397;&#65292;&#26371;&#20808;&#26681;&#25818;&#32317;&#27604;&#20998;&#21028;&#26039;&#21213;&#32773;&#65292;&#28982;&#24460;&#25165;&#26371;&#23436;&#20840;&#37325;&#32622;&#20998;&#25976;
</font></span></font><font face="Arial Unicode MS, serif">--&gt;</font></p>
<p style="margin-bottom: 0in">            &lt;button
id=&quot;reset-button&quot; class=&quot;game-button flex-1&quot;&gt;&#128520;
<font face="Arial"><span lang="zh-CN">&#32066;&#32080;&#23565;&#27770;&#65306;&#23436;&#20840;&#37325;&#32622;&#20998;&#25976;&#20006;&#38283;&#22987;&#26032;&#25136;&#24441;</span></font>&lt;/button&gt;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">&lt;button
id=&quot;end-round-button&quot; onclick=&quot;endRoundImmediately()&quot;
class=&quot;game-button flex-1&quot; title=&quot;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30070;&#26827;&#30436;&#21345;&#20303;&#25110;&#20320;&#19981;&#24819;&#32380;&#32396;&#26178;&#20351;&#29992;&#12290;</font></span></font><font face="Arial Unicode MS, serif">&quot;&gt;</font></p>
<p style="margin-bottom: 0in">                &#8987; <font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25552;&#21069;&#25237;&#38477;</font></span></font><font face="Arial Unicode MS, serif">/</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#32080;&#31639;&#26412;&#22238;&#21512;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#32218;&#22810;&#32773;&#29554;&#21213;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">            &lt;/button&gt;</p>
<p style="margin-bottom: 0in">        &lt;/div&gt;</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">    &lt;/div&gt;</p>
<p style="margin-bottom: 0in">    
</p>
<p style="margin-bottom: 0in">    &lt;!-- &#127942; <font face="Arial"><span lang="zh-CN">&#26368;&#32066;&#21213;&#32773;&#24950;&#31069;&#30059;&#38754;
</span></font>(Modal) &#127942; --&gt;</p>
<p style="margin-bottom: 0in">    &lt;div id=&quot;celebration-modal&quot;
class=&quot;hidden fixed inset-0 z-50 bg-black bg-opacity-70 flex
justify-center items-center transition-opacity duration-500&quot;&gt;</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">&lt;!--
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24907;&#26694;&#20839;&#23481;&#65292;&#20351;&#29992;
</font></span></font><font face="Arial Unicode MS, serif">Neon </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20027;&#38988;&#39080;&#26684;
</font></span></font><font face="Arial Unicode MS, serif">--&gt;</font></p>
<p style="margin-bottom: 0in">        &lt;div id=&quot;modal-content&quot;
class=&quot;p-8 rounded-2xl shadow-2xl w-11/12 max-w-md text-center
border-4&quot;&gt;</p>
<p style="margin-bottom: 0in">            &lt;h2 id=&quot;modal-title&quot;
class=&quot;text-4xl font-extrabold mb-4&quot;&gt;&lt;/h2&gt;</p>
<p style="margin-bottom: 0in">            &lt;p id=&quot;modal-message&quot;
class=&quot;text-xl text-gray-300 mb-8 font-semibold&quot;&gt;&lt;/p&gt;</p>
<p style="margin-bottom: 0in">            &lt;button
id=&quot;modal-reset-button&quot; class=&quot;game-button w-full
transform hover:scale-105&quot; 
</p>
<p style="margin-bottom: 0in">                    style=&quot;background:
linear-gradient(90deg, #ff3366, #bf00ff); color: #1a202c;&quot;&gt;</p>
<p style="margin-bottom: 0in">                &#9876;&#65039;
<font face="Arial"><span lang="zh-CN">&#25509;&#21463;&#39764;&#29579;&#25361;&#25136;&#65281;&#38283;&#22987;&#26032;&#30340;&#25136;&#24441;&#65281;</span></font>(<font face="Arial"><span lang="zh-CN">&#37325;&#32622;&#32317;&#27604;&#20998;</span></font>)</p>
<p style="margin-bottom: 0in">            &lt;/button&gt;</p>
<p style="margin-bottom: 0in">        &lt;/div&gt;</p>
<p style="margin-bottom: 0in">    &lt;/div&gt;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">    &lt;script&gt;</p>
<p style="margin-bottom: 0in">        const BOARD_SIZE = 9;</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">const
WIN_LENGTH = 5; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21083;&#22909;&#36899;&#25104;
</font></span></font><font face="Arial Unicode MS, serif">5 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20491;&#31526;&#34399;&#25165;&#31639;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">const
LINES_TO_WIN = 4; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38656;&#35201;
</font></span></font><font face="Arial Unicode MS, serif">4
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;&#25165;&#33021;&#36111;&#24471;&#26412;&#22238;&#21512;&#30340;
</font></span></font><font face="Arial Unicode MS, serif">1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20998;</font></span></font></p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">const
MATCH_WINS_TO_END = 3; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29575;&#20808;&#29554;&#24471;
</font></span></font><font face="Arial Unicode MS, serif">3 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20998;&#32773;&#65292;&#36111;&#24471;&#25972;&#22580;&#23565;&#27770;</font></span></font></p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#38627;&#24230;&#35373;&#23450;
</font></span></font><font face="Arial Unicode MS, serif">AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24605;&#32771;&#24310;&#36978;&#26178;&#38291;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27627;&#31186;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">        const AI_DELAY_MS = {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">'simple':
1500,  // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20365;&#34907;&#32026;</font></span></font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">'normal':
1000,  // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23559;&#36557;&#32026;</font></span></font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">'difficult':
750, // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22823;&#39764;&#23566;&#24107;&#32026;</font></span></font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">'hell':
500       // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26997;&#38480;&#39764;&#29579;&#32026;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26368;&#24555;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">        };</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25152;&#26377;&#21487;&#36984;&#30340;&#26827;&#23376;&#27171;&#24335;&#23450;&#32681;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26032;&#22686;
</font></span></font><font face="Arial Unicode MS, serif">ROBOT,
NEBULA, GALAXY)</font></p>
<p style="margin-bottom: 0in">        const PIECES = {</p>
<p style="margin-bottom: 0in">            'UFO': { symbol: '&#128760;',
name: '<font face="Arial"><span lang="zh-CN">&#20405;&#30053;&#32773;
</span></font>(<font face="Arial"><span lang="zh-CN">&#32005;</span></font>)',
class: 'ufo', color: '#ff3366' },</p>
<p style="margin-bottom: 0in">            'SATELLITE': { symbol:
'&#128752;&#65039;', name: '<font face="Arial"><span lang="zh-CN">&#38450;&#31142;&#22612;
</span></font>(<font face="Arial"><span lang="zh-CN">&#34253;</span></font>)',
class: 'satellite', color: '#00ccff' },</p>
<p style="margin-bottom: 0in">            'MONSTER': { symbol: '&#128126;',
name: '<font face="Arial"><span lang="zh-CN">&#26143;&#38555;&#24618;&#29560;
</span></font>(<font face="Arial"><span lang="zh-CN">&#32160;</span></font>)',
class: 'monster', color: '#39ff14' },</p>
<p style="margin-bottom: 0in">            'ROCKET': { symbol: '&#128640;',
name: '<font face="Arial"><span lang="zh-CN">&#37504;&#27827;&#28779;&#31661;
</span></font>(<font face="Arial"><span lang="zh-CN">&#32043;</span></font>)',
class: 'rocket', color: '#bf00ff' },</p>
<p style="margin-bottom: 0in">            'STAR': { symbol: '&#127775;',
name: '<font face="Arial"><span lang="zh-CN">&#38275;&#32768;&#20043;&#26143;
</span></font>(<font face="Arial"><span lang="zh-CN">&#40643;</span></font>)',
class: 'star', color: '#ffd700' }, 
</p>
<p style="margin-bottom: 0in">            'COMET': { symbol: '&#9732;&#65039;',
name: '<font face="Arial"><span lang="zh-CN">&#24407;&#26143; </span></font>(<font face="Arial"><span lang="zh-CN">&#27225;</span></font>)',
class: 'comet', color: '#ff8c00' },</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
--- </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26032;&#22686;&#36896;&#22411;
</font></span></font><font face="Arial Unicode MS, serif">---</font></p>
<p style="margin-bottom: 0in">            'ROBOT': { symbol: '&#129302;',
name: '<font face="Arial"><span lang="zh-CN">&#37504;&#27827;&#27231;&#22120;&#20154;
</span></font>(<font face="Arial"><span lang="zh-CN">&#30333;</span></font>)',
class: 'robot', color: '#ffffff' }, 
</p>
<p style="margin-bottom: 0in">            'NEBULA': { symbol: '&#127787;&#65039;',
name: '<font face="Arial"><span lang="zh-CN">&#24187;&#24433;&#26143;&#38642;
</span></font>(<font face="Arial"><span lang="zh-CN">&#38738;&#32160;</span></font>)',
class: 'nebula', color: '#00ffff' },</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">'GALAXY':
{ symbol: '&#10024;', name: '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38275;&#32768;&#37504;&#27827;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31881;&#32005;</font></span></font><font face="Arial Unicode MS, serif">)',
class: 'galaxy', color: '#ff69b4' }</font></p>
<p style="margin-bottom: 0in">        };</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36938;&#25138;&#29376;&#24907;&#35722;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">        let board =
Array(BOARD_SIZE).fill(null).map(() =&gt;
Array(BOARD_SIZE).fill(null));</p>
<p style="margin-bottom: 0in">        let isGameActive = true;</p>
<p style="margin-bottom: 0in">        let cells = [];</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26032;&#22686;&#36938;&#25138;&#27169;&#24335;&#21644;
</font></span></font><font face="Arial Unicode MS, serif">AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29376;&#24907;</font></span></font></p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">let
gameMode = 'PVC'; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38928;&#35373;&#28858;
</font></span></font><font face="Arial Unicode MS, serif">PVC</font></p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">let
difficultyLevel = 'hell'; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38928;&#35373;&#38627;&#24230;</font></span></font></p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30070;&#21069;&#30340;&#29609;&#23478;&#37197;&#32622;</font></span></font></p>
<p style="margin-bottom: 0in">        let currentP1Key = 'UFO';</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">let
currentP2Key = 'MONSTER'; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39764;&#29579;&#30340;&#38928;&#35373;&#31526;&#34399;</font></span></font></p>
<p style="margin-bottom: 0in">        let currentP1Config =
PIECES[currentP1Key];</p>
<p style="margin-bottom: 0in">        let currentP2Config =
PIECES[currentP2Key];</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">let
currentPlayerSymbol = currentP1Config.symbol; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29694;&#22312;&#30340;&#29609;&#23478;&#31526;&#34399;</font></span></font></p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36861;&#36452;</font></span></font><font face="Arial Unicode MS, serif">**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#32047;&#31309;</font></span></font><font face="Arial Unicode MS, serif">**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29554;&#21213;&#32218;&#30340;&#25976;&#37327;&#65288;&#22810;&#22238;&#21512;&#36899;&#32218;&#25976;&#65289;</font></span></font></p>
<p style="margin-bottom: 0in">        let currentLineCounts = {}; //
{ '&#128760;': 0, '&#128126;': 0, ... }</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">let
allRegisteredWinPaths = []; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36861;&#36452;&#30070;&#21069;&#26827;&#30436;&#19978;&#24050;&#36899;&#32218;&#30340;&#24231;&#27161;</font></span></font></p>
<p style="margin-bottom: 0in">        let registeredWinIds = new
Set(); 
</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36861;&#36452;</font></span></font><font face="Arial Unicode MS, serif">**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#32317;&#23565;&#27770;</font></span></font><font face="Arial Unicode MS, serif">**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20998;&#25976;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22238;&#21512;&#29554;&#21213;&#27425;&#25976;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">        let matchScores = {}; // {
'&#128760;': 0, '&#128126;': 0, 'draws': 0 }</p>
<p style="margin-bottom: 0in">        let isAITurn = false;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        const boardElement =
document.getElementById('board');</p>
<p style="margin-bottom: 0in">        const statusElement =
document.getElementById('status');</p>
<p style="margin-bottom: 0in">        const scoreDisplayBox =
document.getElementById('score-display-box'); 
</p>
<p style="margin-bottom: 0in">        const resetButton =
document.getElementById('reset-button');</p>
<p style="margin-bottom: 0in">        const endRoundButton =
document.getElementById('end-round-button'); 
</p>
<p style="margin-bottom: 0in">        const p1ThemeSelector =
document.getElementById('p1-theme');</p>
<p style="margin-bottom: 0in">        const p2ThemeSelector =
document.getElementById('p2-theme');</p>
<p style="margin-bottom: 0in">        const gameModeSelector =
document.getElementById('game-mode');</p>
<p style="margin-bottom: 0in">        const difficultySelector =
document.getElementById('difficulty');</p>
<p style="margin-bottom: 0in">        const difficultyControlElement
= document.getElementById('difficulty-control');</p>
<p style="margin-bottom: 0in">        const p2LabelElement =
document.getElementById('p2-label'); // P2 Label element</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24907;&#26694;&#30456;&#38364;&#20803;&#32032;</font></span></font></p>
<p style="margin-bottom: 0in">        const celebrationModal =
document.getElementById('celebration-modal');</p>
<p style="margin-bottom: 0in">        const modalContent =
document.getElementById('modal-content');</p>
<p style="margin-bottom: 0in">        const modalTitle =
document.getElementById('modal-title');</p>
<p style="margin-bottom: 0in">        const modalMessage =
document.getElementById('modal-message');</p>
<p style="margin-bottom: 0in">        const modalResetButton =
document.getElementById('modal-reset-button');</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        // --- Theme and Mode Selection
Logic ---</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#30070;&#21069;&#27169;&#24335;&#26356;&#26032;
</font></span></font><font face="Arial Unicode MS, serif">P2
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36984;&#25799;&#22120;&#30340;&#27161;&#31844;&#21644;&#31105;&#29992;&#29376;&#24907;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function updateP2Controls() {</p>
<p style="margin-bottom: 0in">            if (gameMode === 'PVC') {</p>
<p style="margin-bottom: 0in">               
p2LabelElement.textContent = `&#128520; <font face="Arial"><span lang="zh-CN">&#39764;&#29579;
</span></font>(${currentP2Config.name}):`;</p>
<p style="margin-bottom: 0in">               
p2ThemeSelector.disabled = true;</p>
<p style="margin-bottom: 0in">            } else {</p>
<p style="margin-bottom: 0in">               
<font face="Arial Unicode MS, serif">p2LabelElement.textContent =
'</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23431;&#23449;&#25136;&#22763;
</font></span></font><font face="Arial Unicode MS, serif">2 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#34399;</font></span></font><font face="Arial Unicode MS, serif">:';</font></p>
<p style="margin-bottom: 0in">               
p2ThemeSelector.disabled = false;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22635;&#20805;&#36984;&#25799;&#22120;&#20006;&#35373;&#32622;&#21021;&#22987;&#20540;&#21644;&#20107;&#20214;&#30435;&#32893;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function initThemeSelectors() {</p>
<p style="margin-bottom: 0in">            const pieceKeys =
Object.keys(PIECES);</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22635;&#20805;
</font></span></font><font face="Arial Unicode MS, serif">P1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21644;
</font></span></font><font face="Arial Unicode MS, serif">P2 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36984;&#25799;&#22120;</font></span></font></p>
<p style="margin-bottom: 0in">            pieceKeys.forEach(key =&gt;
{</p>
<p style="margin-bottom: 0in">                const optionP1 = new
Option(PIECES[key].name, key);</p>
<p style="margin-bottom: 0in">                const optionP2 = new
Option(PIECES[key].name, key);</p>
<p style="margin-bottom: 0in">               
p1ThemeSelector.add(optionP1);</p>
<p style="margin-bottom: 0in">               
p2ThemeSelector.add(optionP2);</p>
<p style="margin-bottom: 0in">            });</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35373;&#32622;&#21021;&#22987;&#36984;&#25799;&#20540;</font></span></font></p>
<p style="margin-bottom: 0in">            p1ThemeSelector.value =
currentP1Key;</p>
<p style="margin-bottom: 0in">            p2ThemeSelector.value =
currentP2Key;</p>
<p style="margin-bottom: 0in">            gameModeSelector.value =
gameMode;</p>
<p style="margin-bottom: 0in">            difficultySelector.value =
difficultyLevel;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35373;&#32622;&#20027;&#38988;&#36984;&#25799;&#20107;&#20214;&#30435;&#32893;&#22120;</font></span></font></p>
<p style="margin-bottom: 0in">           
p1ThemeSelector.addEventListener('change', () =&gt; {</p>
<p style="margin-bottom: 0in">                currentP1Key =
p1ThemeSelector.value;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">startNewMatch(true);
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35722;&#26356;&#20027;&#38988;</font></span></font><font face="Arial Unicode MS, serif">/</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24335;&#26178;&#65292;&#37325;&#32622;&#25152;&#26377;&#20998;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">            });</p>
<p style="margin-bottom: 0in">           
p2ThemeSelector.addEventListener('change', () =&gt; {</p>
<p style="margin-bottom: 0in">                currentP2Key =
p2ThemeSelector.value;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">startNewMatch(true);
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35722;&#26356;&#20027;&#38988;</font></span></font><font face="Arial Unicode MS, serif">/</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24335;&#26178;&#65292;&#37325;&#32622;&#25152;&#26377;&#20998;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">            });</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35373;&#32622;&#27169;&#24335;&#36984;&#25799;&#20107;&#20214;&#30435;&#32893;&#22120;</font></span></font></p>
<p style="margin-bottom: 0in">           
gameModeSelector.addEventListener('change', () =&gt; {</p>
<p style="margin-bottom: 0in">                gameMode =
gameModeSelector.value;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;</font></span></font><font face="Arial Unicode MS, serif">/</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38577;&#34255;&#38627;&#24230;&#36984;&#25799;&#22120;</font></span></font></p>
<p style="margin-bottom: 0in">                if (gameMode === 'PVC')
{</p>
<p style="margin-bottom: 0in">                   
difficultyControlElement.classList.remove('hidden');</p>
<p style="margin-bottom: 0in">                } else {</p>
<p style="margin-bottom: 0in">                   
difficultyControlElement.classList.add('hidden');</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">startNewMatch(true);
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35722;&#26356;&#20027;&#38988;</font></span></font><font face="Arial Unicode MS, serif">/</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24335;&#26178;&#65292;&#37325;&#32622;&#25152;&#26377;&#20998;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">            });</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35373;&#32622;&#38627;&#24230;&#36984;&#25799;&#20107;&#20214;&#30435;&#32893;&#22120;</font></span></font></p>
<p style="margin-bottom: 0in">           
difficultySelector.addEventListener('change', () =&gt; {</p>
<p style="margin-bottom: 0in">                difficultyLevel =
difficultySelector.value;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">startNewMatch(true);
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35722;&#26356;&#38627;&#24230;&#26178;&#65292;&#37325;&#32622;&#25152;&#26377;&#20998;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">            });</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35373;&#32622;&#27169;&#24907;&#26694;&#25353;&#37397;&#30340;&#20107;&#20214;&#30435;&#32893;&#22120;</font></span></font></p>
<p style="margin-bottom: 0in">           
modalResetButton.addEventListener('click', () =&gt;
hideCelebrationModal(true));</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#36938;&#25138;&#27169;&#24335;&#21644;&#38627;&#24230;&#32026;&#21029;&#26356;&#26032;&#25552;&#21069;&#32080;&#26463;&#22238;&#21512;&#25353;&#37397;&#30340;&#29376;&#24907;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
updateEndRoundButtonState() {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39764;&#29579;&#32026;
</font></span></font><font face="Arial Unicode MS, serif">(hell)
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24335;&#19979;&#31105;&#29992;&#25552;&#21069;&#32080;&#31639;</font></span></font></p>
<p style="margin-bottom: 0in">            const isHellMode = gameMode
=== 'PVC' &amp;&amp; difficultyLevel === 'hell';</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            if (isHellMode) {</p>
<p style="margin-bottom: 0in">                endRoundButton.disabled
= true;</p>
<p style="margin-bottom: 0in">               
<font face="Arial Unicode MS, serif">endRoundButton.textContent = '&#10060;
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39764;&#29579;&#25361;&#25136;&#20013;&#65306;&#31105;&#27490;&#25552;&#21069;&#32080;&#31639;&#65281;</font></span></font><font face="Arial Unicode MS, serif">';</font></p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">endRoundButton.title
= '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26997;&#38480;&#39764;&#29579;&#32026;&#25361;&#25136;&#24517;&#38920;&#23436;&#20840;&#20998;&#20986;&#21213;&#36000;&#25165;&#33021;&#32080;&#26463;&#26412;&#22238;&#21512;&#12290;</font></span></font><font face="Arial Unicode MS, serif">';</font></p>
<p style="margin-bottom: 0in">            } else {</p>
<p style="margin-bottom: 0in">                endRoundButton.disabled
= false;</p>
<p style="margin-bottom: 0in">               
<font face="Arial Unicode MS, serif">endRoundButton.textContent = '&#8987;
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25552;&#21069;&#25237;&#38477;</font></span></font><font face="Arial Unicode MS, serif">/</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#32080;&#31639;&#26412;&#22238;&#21512;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#32218;&#22810;&#32773;&#29554;&#21213;</font></span></font><font face="Arial Unicode MS, serif">)';</font></p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">endRoundButton.title
= '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30070;&#26827;&#30436;&#21345;&#20303;&#25110;&#20320;&#19981;&#24819;&#32380;&#32396;&#26178;&#20351;&#29992;&#12290;</font></span></font><font face="Arial Unicode MS, serif">';</font></p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#36984;&#25799;&#22120;&#26356;&#26032;&#30070;&#21069;&#30340;&#29609;&#23478;&#37197;&#32622;&#65292;&#20006;&#34389;&#29702;
</font></span></font><font face="Arial Unicode MS, serif">PvP/PvC
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#34909;&#31361;&#21644;
</font></span></font><font face="Arial Unicode MS, serif">UI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function updateThemeConfig() {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">const
defaultAISymbolKey = 'MONSTER'; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39764;&#29579;&#36557;&#22296;&#30340;&#38928;&#35373;&#31526;&#34399;</font></span></font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">const
fallbackAISymbolKey = 'SATELLITE'; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20633;&#29992;&#31526;&#34399;</font></span></font></p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            if (gameMode === 'PVC') {</p>
<p style="margin-bottom: 0in">                // --- PvC Mode (Demon
King Red Theme) ---</p>
<p style="margin-bottom: 0in">               
difficultyControlElement.classList.remove('hidden');</p>
<p style="margin-bottom: 0in">               
<font face="Arial Unicode MS, serif">boardElement.classList.remove('pvp-blue-border');
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31227;&#38500;&#34253;&#33394;&#37002;&#26694;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20351;&#29992;&#38928;&#35373;&#32005;&#33394;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">               
<font face="Arial Unicode MS, serif">scoreDisplayBox.classList.remove('pvp-blue-border');
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31227;&#38500;&#20998;&#25976;&#26694;&#30340;&#34253;&#33394;&#37002;&#26694;</font></span></font></p>
<p style="margin-bottom: 0in">                
</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30906;&#20445;
</font></span></font><font face="Arial Unicode MS, serif">P1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21644;
</font></span></font><font face="Arial Unicode MS, serif">P2 (AI)
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31526;&#34399;&#19981;&#21516;&#65292;&#20006;&#30433;&#21487;&#33021;&#35731;
</font></span></font><font face="Arial Unicode MS, serif">AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20445;&#25345;&#38928;&#35373;&#31526;&#34399;</font></span></font></p>
<p style="margin-bottom: 0in">                if (currentP1Key ===
defaultAISymbolKey) {</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">currentP2Key
= fallbackAISymbolKey; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;
</font></span></font><font face="Arial Unicode MS, serif">P1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36984;&#25799;&#20102;&#38928;&#35373;
</font></span></font><font face="Arial Unicode MS, serif">AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31526;&#34399;
</font></span></font><font face="Arial Unicode MS, serif">(MONSTER)</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65292;</font></span></font><font face="Arial Unicode MS, serif">AI
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21063;&#20999;&#25563;&#28858;
</font></span></font><font face="Arial Unicode MS, serif">SATELLITE</font></p>
<p style="margin-bottom: 0in">                   
p2ThemeSelector.value = currentP2Key;</p>
<p style="margin-bottom: 0in">                   
showTemporaryMessage('&#128520; <font face="Arial"><span lang="zh-CN">&#39764;&#29579;&#36557;&#22296;&#30340;&#31526;&#34399;&#24050;&#33258;&#21205;&#35519;&#25972;&#12290;</span></font>',
'text-yellow-400');</p>
<p style="margin-bottom: 0in">                } else {</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">currentP2Key
= defaultAISymbolKey; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21542;&#21063;
</font></span></font><font face="Arial Unicode MS, serif">AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20445;&#25345;&#38928;&#35373;
</font></span></font><font face="Arial Unicode MS, serif">(MONSTER)</font></p>
<p style="margin-bottom: 0in">                   
p2ThemeSelector.value = currentP2Key;</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">                
</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30001;&#26044;
</font></span></font><font face="Arial Unicode MS, serif">P2
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36984;&#38917;&#24050;&#34987;&#22266;&#23450;&#65292;&#26356;&#26032;
</font></span></font><font face="Arial Unicode MS, serif">CSS
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35731;&#23427;&#30475;&#36215;&#20358;&#20687;&#24509;&#31456;</font></span></font></p>
<p style="margin-bottom: 0in">               
p2ThemeSelector.style.borderColor = PIECES[currentP2Key].color;</p>
<p style="margin-bottom: 0in">               
p2ThemeSelector.style.color = PIECES[currentP2Key].color;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            } else {</p>
<p style="margin-bottom: 0in">                // --- PvP Mode (Space
Warrior Blue Theme) ---</p>
<p style="margin-bottom: 0in">               
difficultyControlElement.classList.add('hidden');</p>
<p style="margin-bottom: 0in">               
<font face="Arial Unicode MS, serif">boardElement.classList.add('pvp-blue-border');
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26032;&#22686;&#26827;&#30436;&#34253;&#33394;&#37002;&#26694;</font></span></font></p>
<p style="margin-bottom: 0in">               
<font face="Arial Unicode MS, serif">scoreDisplayBox.classList.add('pvp-blue-border');
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26032;&#22686;&#20998;&#25976;&#26694;&#30340;&#34253;&#33394;&#37002;&#26694;</font></span></font></p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;
</font></span></font><font face="Arial Unicode MS, serif">PvP
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24335;&#19979;&#30340;&#31526;&#34399;&#37325;&#35079;</font></span></font></p>
<p style="margin-bottom: 0in">                if (currentP1Key ===
currentP2Key) {</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36942;&#28670;&#25481;
</font></span></font><font face="Arial Unicode MS, serif">P1
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36984;&#25799;&#30340;&#31526;&#34399;&#65292;&#25214;&#21040;&#31532;&#19968;&#20491;&#21487;&#29992;&#30340;&#20316;&#28858;
</font></span></font><font face="Arial Unicode MS, serif">P2 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#20633;&#36984;</font></span></font></p>
<p style="margin-bottom: 0in">                    const availableKeys
= Object.keys(PIECES).filter(key =&gt; key !== currentP1Key);</p>
<p style="margin-bottom: 0in">                    
</p>
<p style="margin-bottom: 0in">                    let newP2Key = ''; 
</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30906;&#20445;&#33267;&#23569;&#26377;&#19968;&#20491;&#20633;&#36984;&#31526;&#34399;&#65292;&#21542;&#21063;&#20351;&#29992;&#31532;&#19968;&#20491;&#31526;&#34399;</font></span></font></p>
<p style="margin-bottom: 0in">                    if
(availableKeys.length &gt; 0) {</p>
<p style="margin-bottom: 0in">                        newP2Key =
availableKeys[0]; 
</p>
<p style="margin-bottom: 0in">                    } else {</p>
<p style="margin-bottom: 0in">                         <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29702;&#35542;&#19978;&#19981;&#26371;&#30332;&#29983;&#65292;&#38500;&#38750;
</font></span></font><font face="Arial Unicode MS, serif">PIECES
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21482;&#26377;&#19968;&#20491;&#20803;&#32032;</font></span></font></p>
<p style="margin-bottom: 0in">                         newP2Key =
Object.keys(PIECES)[0];</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                    
</p>
<p style="margin-bottom: 0in">                    if (currentP1Key
=== currentP2Key) {</p>
<p style="margin-bottom: 0in">                        currentP2Key =
newP2Key;</p>
<p style="margin-bottom: 0in">                       
p2ThemeSelector.value = currentP2Key;</p>
<p style="margin-bottom: 0in">                       
showTemporaryMessage('&#9888;&#65039; <font face="Arial"><span lang="zh-CN">&#23431;&#23449;&#25136;&#22763;
</span></font>1 <font face="Arial"><span lang="zh-CN">&#34399;&#21644;
</span></font>2 <font face="Arial"><span lang="zh-CN">&#34399;&#24517;&#38920;&#36984;&#25799;&#19981;&#21516;&#30340;&#31526;&#34399;&#65281;&#24050;&#33258;&#21205;&#28858;
</span></font>2 <font face="Arial"><span lang="zh-CN">&#34399;&#26356;&#25913;&#12290;</span></font>',
'text-yellow-400');</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">                
</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24674;&#24489;
</font></span></font><font face="Arial Unicode MS, serif">P2 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36984;&#38917;&#30340;&#38928;&#35373;&#27171;&#24335;</font></span></font></p>
<p style="margin-bottom: 0in">               
p2ThemeSelector.style.borderColor = '';</p>
<p style="margin-bottom: 0in">               
p2ThemeSelector.style.color = '';</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            currentP1Config =
PIECES[currentP1Key];</p>
<p style="margin-bottom: 0in">            currentP2Config =
PIECES[currentP2Key];</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26356;&#26032;
</font></span></font><font face="Arial Unicode MS, serif">P2 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27161;&#31844;&#21644;&#31105;&#29992;&#29376;&#24907;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#34389;&#29702;&#37782;&#23450;&#35222;&#35258;&#25928;&#26524;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">            updateP2Controls();</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#27169;&#24335;&#21644;&#38627;&#24230;&#26356;&#26032;&#25552;&#21069;&#32080;&#26463;&#25353;&#37397;&#29376;&#24907;</font></span></font></p>
<p style="margin-bottom: 0in">           
updateEndRoundButtonState();</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#26283;&#26178;&#30340;&#29376;&#24907;&#35338;&#24687;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
showTemporaryMessage(message, colorClass) {</p>
<p style="margin-bottom: 0in">            statusElement.innerHTML =
`&lt;span class=&quot;${colorClass} font-bold&quot;&gt;${message}&lt;/span&gt;`;</p>
<p style="margin-bottom: 0in">            statusElement.className =
'font-bold text-lg';</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">setTimeout(updateStatus,
3000); // 3</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31186;&#24460;&#24674;&#24489;&#27491;&#24120;&#29376;&#24907;&#39023;&#31034;</font></span></font></p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        // --- Core Game Logic (Move
execution) ---</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Finds all complete winning
lines (EXACTLY WIN_LENGTH long) passing through (r, c).</p>
<p style="margin-bottom: 0in">         * @param {number} r - Row
index.</p>
<p style="margin-bottom: 0in">         * @param {number} c - Column
index.</p>
<p style="margin-bottom: 0in">         * @param {string} player - The
current player symbol.</p>
<p style="margin-bottom: 0in">         * @returns
{Array&lt;Array&lt;[number, number]&gt;&gt;} - Array of new winning
paths (list of [r, c] pairs).</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function findNewWinningLines(r,
c, player) {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36889;&#20491;&#20989;&#25976;&#24517;&#38920;&#26159;&#28961;&#21103;&#20316;&#29992;&#30340;&#65292;&#21482;&#35336;&#31639;&#26032;&#36899;&#32218;</font></span></font></p>
<p style="margin-bottom: 0in">            return
checkSimulatedNewLines(r, c, player, registeredWinIds, true);</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Helper function to check for
new lines in simulation or actual turn.</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37325;&#35201;&#26356;&#26032;&#65306;&#27492;&#20989;&#25976;&#29694;&#22312;&#21482;&#35336;&#31639;&#38263;&#24230;&#21083;&#22909;&#28858;
</font></span></font><font face="Arial Unicode MS, serif">WIN_LENGTH
(5) </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#36899;&#32396;&#32218;&#65292;&#38263;&#36899;&#19981;&#35336;&#20998;&#12290;</font></span></font><font face="Arial Unicode MS, serif">**</font></p>
<p style="margin-bottom: 0in">         * @param {number} r 
</p>
<p style="margin-bottom: 0in">         * @param {number} c 
</p>
<p style="margin-bottom: 0in">         * @param {string} player 
</p>
<p style="margin-bottom: 0in">         * @param {Set&lt;string&gt;}
idSet - The set used to check if a line is already registered.</p>
<p style="margin-bottom: 0in">         * @param {boolean}
[modifySet=false] - Whether to modify the idSet (for actual turn).</p>
<p style="margin-bottom: 0in">         * @returns {Array}</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
checkSimulatedNewLines(r, c, player, idSet, modifySet = false) {</p>
<p style="margin-bottom: 0in">            const directions = [</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">{
dr: 0, dc: 1 },  // Horizontal (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27700;&#24179;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">{
dr: 1, dc: 0 },  // Vertical (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22402;&#30452;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">{
dr: 1, dc: 1 },  // Diagonal \ (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20027;&#23565;&#35282;&#32218;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">{
dr: 1, dc: -1 }  // Diagonal / (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21103;&#23565;&#35282;&#32218;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">            ];</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            let foundLines = [];</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            for (const { dr, dc } of
directions) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
1. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24448;&#36000;&#26041;&#21521;&#35336;&#31639;&#36899;&#32396;&#38263;&#24230;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#19981;&#21253;&#21547;
</font></span></font><font face="Arial Unicode MS, serif">[r, c])</font></p>
<p style="margin-bottom: 0in">                let lineNegative = [];</p>
<p style="margin-bottom: 0in">                for (let k = -1; k &gt;=
-BOARD_SIZE; k--) {</p>
<p style="margin-bottom: 0in">                    const nr = r + k *
dr;</p>
<p style="margin-bottom: 0in">                    const nc = c + k *
dc;</p>
<p style="margin-bottom: 0in">                    if (nr &gt;= 0 &amp;&amp;
nr &lt; BOARD_SIZE &amp;&amp; nc &gt;= 0 &amp;&amp; nc &lt;
BOARD_SIZE &amp;&amp; board[nr][nc] === player) {</p>
<p style="margin-bottom: 0in">                       
lineNegative.unshift([nr, nc]);</p>
<p style="margin-bottom: 0in">                    } else {</p>
<p style="margin-bottom: 0in">                        break;</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
2. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24448;&#27491;&#26041;&#21521;&#35336;&#31639;&#36899;&#32396;&#38263;&#24230;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21253;&#21547;&#30070;&#21069;&#40670;
</font></span></font><font face="Arial Unicode MS, serif">[r, c])</font></p>
<p style="margin-bottom: 0in">                let linePositive = [[r,
c]];</p>
<p style="margin-bottom: 0in">                for (let k = 1; k &lt;
BOARD_SIZE; k++) {</p>
<p style="margin-bottom: 0in">                    const nr = r + k *
dr;</p>
<p style="margin-bottom: 0in">                    const nc = c + k *
dc;</p>
<p style="margin-bottom: 0in">                    if (nr &gt;= 0 &amp;&amp;
nr &lt; BOARD_SIZE &amp;&amp; nc &gt;= 0 &amp;&amp; nc &lt;
BOARD_SIZE &amp;&amp; board[nr][nc] === player) {</p>
<p style="margin-bottom: 0in">                       
linePositive.push([nr, nc]); 
</p>
<p style="margin-bottom: 0in">                    } else {</p>
<p style="margin-bottom: 0in">                        break;</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">                
</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
3. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#32080;&#21512;&#20841;&#20491;&#26041;&#21521;&#30340;&#32080;&#26524;&#65292;&#24471;&#21040;&#21253;&#21547;&#26032;&#33853;&#23376;&#30340;&#26368;&#38263;&#36899;&#32396;&#32218;</font></span></font></p>
<p style="margin-bottom: 0in">                const totalSequence =
[...lineNegative, ...linePositive];</p>
<p style="margin-bottom: 0in">                
</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
4. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#12300;&#38263;&#36899;&#31105;&#35336;&#20998;&#12301;&#35215;&#21063;&#36914;&#34892;&#21028;&#26039;</font></span></font></p>
<p style="margin-bottom: 0in">                if
(totalSequence.length === WIN_LENGTH) {</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38263;&#24230;&#21083;&#22909;&#26159;
</font></span></font><font face="Arial Unicode MS, serif">WIN_LENGTH
(5)</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65292;&#35336;&#20998;&#65281;</font></span></font></p>
<p style="margin-bottom: 0in">                    const line =
totalSequence;</p>
<p style="margin-bottom: 0in">                    
</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29986;&#29983;&#36899;&#32218;&#30340;&#21807;&#19968;
</font></span></font><font face="Arial Unicode MS, serif">ID
(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30906;&#20445;&#25490;&#24207;&#19968;&#33268;&#65292;&#21542;&#21063;
</font></span></font><font face="Arial Unicode MS, serif">Set </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26371;&#35492;&#21028;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                    const lineId =
JSON.stringify(line.sort((a, b) =&gt; 
</p>
<p style="margin-bottom: 0in">                        a[0] !== b[0] ?
a[0] - b[0] : a[1] - b[1]</p>
<p style="margin-bottom: 0in">                    ));</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21482;&#26377;&#30070;&#36889;&#26781;&#32218;&#26159;&#26032;&#30340;&#26178;&#25165;&#35336;&#31639;</font></span></font></p>
<p style="margin-bottom: 0in">                    if
(!idSet.has(lineId)) {</p>
<p style="margin-bottom: 0in">                        if (modifySet)
{</p>
<p style="margin-bottom: 0in">                           
idSet.add(lineId);</p>
<p style="margin-bottom: 0in">                        }</p>
<p style="margin-bottom: 0in">                       
foundLines.push(line);</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                } 
</p>
<p style="margin-bottom: 0in">                // else if
(totalSequence.length &gt; WIN_LENGTH) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
    // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36889;&#26159;&#38263;&#36899;
</font></span></font><font face="Arial Unicode MS, serif">(Overline)</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65281;&#26681;&#25818;&#35215;&#21063;&#65292;&#19981;&#35336;&#20998;&#65292;&#36339;&#36942;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">                // }</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            return foundLines; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Executes a move at [r, c]
for the currentPlayerSymbol.</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function executeMove(r, c) {</p>
<p style="margin-bottom: 0in">            const index = r *
BOARD_SIZE + c;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            // 1. Place the piece</p>
<p style="margin-bottom: 0in">            board[r][c] =
currentPlayerSymbol;</p>
<p style="margin-bottom: 0in">            const cellElement =
cells[index];</p>
<p style="margin-bottom: 0in">            cellElement.textContent =
currentPlayerSymbol;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27770;&#23450;&#30070;&#21069;&#31526;&#34399;&#30340;&#37197;&#32622;</font></span></font></p>
<p style="margin-bottom: 0in">            const currentPlayerConfig =
currentPlayerSymbol === currentP1Config.symbol ? currentP1Config :
currentP2Config;</p>
<p style="margin-bottom: 0in">           
cellElement.classList.add(currentPlayerConfig.class);</p>
<p style="margin-bottom: 0in">            cellElement.style.cursor =
'default';</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            // Pop effect</p>
<p style="margin-bottom: 0in">           
cellElement.classList.add('pop-effect');</p>
<p style="margin-bottom: 0in">            setTimeout(() =&gt; {
cellElement.classList.remove('pop-effect'); }, 100);</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
2. Check for NEW winning lines (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26371;&#20462;&#25913;
</font></span></font><font face="Arial Unicode MS, serif">registeredWinIds)</font></p>
<p style="margin-bottom: 0in">            const newLines =
findNewWinningLines(r, c, currentPlayerSymbol);</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            if (newLines.length &gt; 0)
{</p>
<p style="margin-bottom: 0in">               
currentLineCounts[currentPlayerSymbol] =
(currentLineCounts[currentPlayerSymbol] || 0) + newLines.length;</p>
<p style="margin-bottom: 0in">               
allRegisteredWinPaths.push(...newLines);</p>
<p style="margin-bottom: 0in">                
</p>
<p style="margin-bottom: 0in">                // 3. Check for overall
MATCH WIN (LINES_TO_WIN lines needed)</p>
<p style="margin-bottom: 0in">                if
(currentLineCounts[currentPlayerSymbol] &gt;= LINES_TO_WIN) {</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;&#36948;&#21040;&#29554;&#21213;&#26781;&#20214;&#65292;&#30452;&#25509;&#21628;&#21483;
</font></span></font><font face="Arial Unicode MS, serif">handleWin()
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20358;&#34389;&#29702;</font></span></font></p>
<p style="margin-bottom: 0in">                   
handleWin(currentPlayerSymbol);</p>
<p style="margin-bottom: 0in">                    return;</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            // 4. Check for Draw (Board
full but no match winner yet)</p>
<p style="margin-bottom: 0in">            if (checkDraw()) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">handleDraw();
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22312;&#36889;&#35023;&#26371;&#33258;&#21205;&#37325;&#32622;&#26827;&#30436;&#65292;&#20006;&#20445;&#25345;&#36899;&#32218;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">                return;</p>
<p style="margin-bottom: 0in">            } 
</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            // 5. Continue game: Switch
player symbol</p>
<p style="margin-bottom: 0in">            currentPlayerSymbol =
currentPlayerSymbol === currentP1Config.symbol 
</p>
<p style="margin-bottom: 0in">                                    ?
currentP2Config.symbol 
</p>
<p style="margin-bottom: 0in">                                    :
currentP1Config.symbol;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">//
--- AI Logic (</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24801;&#39764;&#32026;&#21029;&#22686;&#24375;&#37007;&#36655;</font></span></font><font face="Arial Unicode MS, serif">)
---</font></p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;&#26159;&#21542;&#26377;&#31435;&#21363;&#29554;&#21213;&#25110;&#38459;&#25803;&#33268;&#21213;&#30340;&#31227;&#21205;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36948;&#21040;
</font></span></font><font face="Arial Unicode MS, serif">LINES_TO_WIN
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;</font></span></font><font face="Arial Unicode MS, serif">)</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
@param {string} symbol - </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;&#27492;&#31526;&#34399;
</font></span></font><font face="Arial Unicode MS, serif">(AI/</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23565;&#25163;&#30340;&#31526;&#34399;</font></span></font><font face="Arial Unicode MS, serif">)
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#21213;&#21033;</font></span></font></p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
@param {string} [opponentSymbol] - </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;&#27492;&#31526;&#34399;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23565;&#25163;&#30340;&#31526;&#34399;</font></span></font><font face="Arial Unicode MS, serif">)
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#38459;&#25803;</font></span></font></p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
@returns {Array&lt;number, number&gt; | null} - </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29554;&#21213;&#25110;&#38459;&#25803;&#30340;&#24231;&#27161;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
getWinningOrBlockingMove(symbol, opponentSymbol = null) {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;&#25552;&#20379;&#20102;
</font></span></font><font face="Arial Unicode MS, serif">opponentSymbol</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65292;&#21063;&#27298;&#26597;&#20841;&#20491;&#31526;&#34399;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20808;&#27298;&#26597;
</font></span></font><font face="Arial Unicode MS, serif">symbol</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65292;&#20877;&#27298;&#26597;
</font></span></font><font face="Arial Unicode MS, serif">opponentSymbol)</font></p>
<p style="margin-bottom: 0in">            const symbolsToCheck =
opponentSymbol ? [symbol, opponentSymbol] : [symbol];</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            for (const checkSymbol of
symbolsToCheck) {</p>
<p style="margin-bottom: 0in">                
</p>
<p style="margin-bottom: 0in">                for (let r = 0; r &lt;
BOARD_SIZE; r++) {</p>
<p style="margin-bottom: 0in">                    for (let c = 0; c &lt;
BOARD_SIZE; c++) {</p>
<p style="margin-bottom: 0in">                        if (board[r][c]
=== null) {</p>
<p style="margin-bottom: 0in">                            // Simulate
move</p>
<p style="margin-bottom: 0in">                            board[r][c]
= checkSymbol;</p>
<p style="margin-bottom: 0in">                            
</p>
<p style="margin-bottom: 0in">                            const
tempRegisteredWinIds = new Set(registeredWinIds); 
</p>
<p style="margin-bottom: 0in">                            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;&#31227;&#21205;
</font></span></font><font face="Arial Unicode MS, serif">[r, c]
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24460;&#26371;&#29986;&#29983;&#22810;&#23569;&#26032;&#32218;</font></span></font></p>
<p style="margin-bottom: 0in">                            const
tempFoundLines = checkSimulatedNewLines(r, c, checkSymbol,
tempRegisteredWinIds, false);</p>
<p style="margin-bottom: 0in">                            
</p>
<p style="margin-bottom: 0in">                            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;&#27492;&#31227;&#21205;&#26159;&#21542;&#36948;&#21040;&#25110;&#36229;&#36942;
</font></span></font><font face="Arial Unicode MS, serif">LINES_TO_WIN</font></p>
<p style="margin-bottom: 0in">                            const
totalLinesAfterMove = (currentLineCounts[checkSymbol] || 0) +
tempFoundLines.length;</p>
<p style="margin-bottom: 0in">                            
</p>
<p style="margin-bottom: 0in">                            if
(totalLinesAfterMove &gt;= LINES_TO_WIN) {</p>
<p style="margin-bottom: 0in">                               
board[r][c] = null; 
</p>
<p style="margin-bottom: 0in">                                <font face="Arial Unicode MS, serif">return
[r, c]; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25214;&#21040;&#29554;&#21213;&#25110;&#38459;&#25803;&#30340;&#31227;&#21205;</font></span></font></p>
<p style="margin-bottom: 0in">                            }</p>
<p style="margin-bottom: 0in">                            
</p>
<p style="margin-bottom: 0in">                            board[r][c]
= null; 
</p>
<p style="margin-bottom: 0in">                        }</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            return null;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;&#25152;&#26377;&#21487;&#33021;&#30340;&#31227;&#21205;&#65292;&#20006;&#36820;&#22238;&#21109;&#36896;&#26368;&#22810;&#26032;&#36899;&#32218;&#30340;&#31227;&#21205;&#21450;&#20854;&#25976;&#37327;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29992;&#26044;&#22320;&#29508;&#27169;&#24335;&#30340;&#20998;&#21449;&#25915;&#25802;&#21644;&#38450;&#31142;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
@param {string} symbol - </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;&#27492;&#31526;&#34399;</font></span></font></p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
@returns {{move: [number, number], count: number} | null} - </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26368;&#20339;&#31227;&#21205;&#21644;&#26032;&#32218;&#25976;&#37327;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
getBestNewLineMoveWithCount(symbol) {</p>
<p style="margin-bottom: 0in">            let bestMove = null;</p>
<p style="margin-bottom: 0in">            let maxLines = 0; 
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">let
bestMoves = []; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29992;&#26044;&#22312;&#36899;&#32218;&#25976;&#30456;&#21516;&#26178;&#36914;&#34892;&#38568;&#27231;&#36984;&#25799;</font></span></font></p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            for (let r = 0; r &lt;
BOARD_SIZE; r++) {</p>
<p style="margin-bottom: 0in">                for (let c = 0; c &lt;
BOARD_SIZE; c++) {</p>
<p style="margin-bottom: 0in">                    if (board[r][c] ===
null) {</p>
<p style="margin-bottom: 0in">                        board[r][c] =
symbol;</p>
<p style="margin-bottom: 0in">                        
</p>
<p style="margin-bottom: 0in">                        const
tempRegisteredWinIds = new Set(registeredWinIds);</p>
<p style="margin-bottom: 0in">                        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;&#31227;&#21205;
</font></span></font><font face="Arial Unicode MS, serif">[r, c]
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24460;&#26371;&#29986;&#29983;&#22810;&#23569;&#26032;&#32218;</font></span></font></p>
<p style="margin-bottom: 0in">                        const
tempFoundLines = checkSimulatedNewLines(r, c, symbol,
tempRegisteredWinIds, false);</p>
<p style="margin-bottom: 0in">                        const
numNewLines = tempFoundLines.length;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                        if (numNewLines
&gt; maxLines) {</p>
<p style="margin-bottom: 0in">                            maxLines =
numNewLines;</p>
<p style="margin-bottom: 0in">                            <font face="Arial Unicode MS, serif">bestMoves
= [[r, c]]; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30332;&#29694;&#26356;&#22909;&#30340;&#65292;&#37325;&#35373;&#21015;&#34920;</font></span></font></p>
<p style="margin-bottom: 0in">                        } else if
(numNewLines === maxLines &amp;&amp; numNewLines &gt; 0) {</p>
<p style="margin-bottom: 0in">                           
<font face="Arial Unicode MS, serif">bestMoves.push([r, c]); //
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36899;&#32218;&#25976;&#30456;&#21516;&#65292;&#21152;&#20837;&#21015;&#34920;</font></span></font></p>
<p style="margin-bottom: 0in">                        }</p>
<p style="margin-bottom: 0in">                        
</p>
<p style="margin-bottom: 0in">                        board[r][c] =
null; 
</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            if (maxLines &gt; 0 &amp;&amp;
bestMoves.length &gt; 0) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24478;&#26368;&#20339;&#31227;&#21205;&#21015;&#34920;&#20013;&#38568;&#27231;&#36984;&#25799;&#19968;&#20491;</font></span></font></p>
<p style="margin-bottom: 0in">                const randomIndex =
Math.floor(Math.random() * bestMoves.length);</p>
<p style="margin-bottom: 0in">                return { move:
bestMoves[randomIndex], count: maxLines };</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            return null;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25214;&#21040;&#26368;&#38752;&#36817;&#20013;&#24515;&#30340;&#21512;&#27861;&#31227;&#21205;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36317;&#38626;&#20013;&#24515;&#40670;&#30340;&#26364;&#21704;&#38931;&#36317;&#38626;&#26368;&#23567;</font></span></font><font face="Arial Unicode MS, serif">)</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         * @returns {Array&lt;number,
number&gt; | null}</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
getCenterProximityMove() {</p>
<p style="margin-bottom: 0in">            const center =
Math.floor(BOARD_SIZE / 2);</p>
<p style="margin-bottom: 0in">            let bestMove = null;</p>
<p style="margin-bottom: 0in">            let minDistance = Infinity;</p>
<p style="margin-bottom: 0in">            let centerMoves = [];</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            for (let r = 0; r &lt;
BOARD_SIZE; r++) {</p>
<p style="margin-bottom: 0in">                for (let c = 0; c &lt;
BOARD_SIZE; c++) {</p>
<p style="margin-bottom: 0in">                    if (board[r][c] ===
null) {</p>
<p style="margin-bottom: 0in">                        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20351;&#29992;&#26364;&#21704;&#38931;&#36317;&#38626;
</font></span></font><font face="Arial Unicode MS, serif">(Manhattan
distance)</font></p>
<p style="margin-bottom: 0in">                        const distance
= Math.abs(r - center) + Math.abs(c - center);</p>
<p style="margin-bottom: 0in">                        
</p>
<p style="margin-bottom: 0in">                        if (distance &lt;
minDistance) {</p>
<p style="margin-bottom: 0in">                            minDistance
= distance;</p>
<p style="margin-bottom: 0in">                            centerMoves
= [[r, c]];</p>
<p style="margin-bottom: 0in">                        } else if
(distance === minDistance) {</p>
<p style="margin-bottom: 0in">                           
centerMoves.push([r, c]);</p>
<p style="margin-bottom: 0in">                        }</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            if (centerMoves.length &gt;
0) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24478;&#36317;&#38626;&#26368;&#30701;&#30340;&#21015;&#34920;&#20013;&#38568;&#27231;&#36984;&#25799;&#19968;&#20491;</font></span></font></p>
<p style="margin-bottom: 0in">                const randomIndex =
Math.floor(Math.random() * centerMoves.length);</p>
<p style="margin-bottom: 0in">                return
centerMoves[randomIndex];</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            return null;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38568;&#27231;&#36984;&#25799;&#19968;&#20491;&#21487;&#29992;&#30340;&#26684;&#23376;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         * @returns {Array&lt;number,
number&gt; | null}</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function getRandomLegalMove() {</p>
<p style="margin-bottom: 0in">            const availableMoves = [];</p>
<p style="margin-bottom: 0in">            for (let r = 0; r &lt;
BOARD_SIZE; r++) {</p>
<p style="margin-bottom: 0in">                for (let c = 0; c &lt;
BOARD_SIZE; c++) {</p>
<p style="margin-bottom: 0in">                    if (board[r][c] ===
null) {</p>
<p style="margin-bottom: 0in">                       
availableMoves.push([r, c]);</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            if (availableMoves.length &gt;
0) {</p>
<p style="margin-bottom: 0in">                return
availableMoves[Math.floor(Math.random() * availableMoves.length)];</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            return null; 
</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#38627;&#24230;&#27770;&#23450;
</font></span></font><font face="Arial Unicode MS, serif">AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#31227;&#21205;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function getComputerMove() {</p>
<p style="margin-bottom: 0in">            const aiSymbol =
currentP2Config.symbol;</p>
<p style="margin-bottom: 0in">            const humanSymbol =
currentP1Config.symbol;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
--- </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26680;&#24515;&#31574;&#30053;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25152;&#26377;&#38627;&#24230;&#37117;&#26371;&#22519;&#34892;</font></span></font><font face="Arial Unicode MS, serif">)
---</font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
1. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31435;&#21363;&#29554;&#21213;&#65306;&#27298;&#26597;
</font></span></font><font face="Arial Unicode MS, serif">AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26159;&#21542;&#33021;&#31227;&#21205;&#24460;&#36948;&#21040;
</font></span></font><font face="Arial Unicode MS, serif">4 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;&#36111;&#24471;&#26412;&#22238;&#21512;</font></span></font></p>
<p style="margin-bottom: 0in">            const aiWinMove =
getWinningOrBlockingMove(aiSymbol);</p>
<p style="margin-bottom: 0in">            if (aiWinMove) return
aiWinMove;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
2. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31435;&#21363;&#38459;&#25803;&#65306;&#27298;&#26597;&#23565;&#25163;&#26159;&#21542;&#33021;&#31227;&#21205;&#24460;&#36948;&#21040;
</font></span></font><font face="Arial Unicode MS, serif">4 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;&#36111;&#24471;&#26412;&#22238;&#21512;</font></span></font></p>
<p style="margin-bottom: 0in">            const humanWinBlock =
getWinningOrBlockingMove(humanSymbol);</p>
<p style="margin-bottom: 0in">            if (humanWinBlock) return
humanWinBlock;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
--- </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38627;&#24230;&#20998;&#32026;&#31574;&#30053;
</font></span></font><font face="Arial Unicode MS, serif">---</font></p>
<p style="margin-bottom: 0in">            switch (difficultyLevel) {</p>
<p style="margin-bottom: 0in">                case 'simple':</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20365;&#34907;&#32026;&#65306;&#20778;&#20808;&#23563;&#25214;&#21934;&#32218;
</font></span></font><font face="Arial Unicode MS, serif">(50%
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27231;&#29575;</font></span></font><font face="Arial Unicode MS, serif">)</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65292;&#21542;&#21063;&#38568;&#27231;</font></span></font></p>
<p style="margin-bottom: 0in">                    if (Math.random() &lt;
0.5) {</p>
<p style="margin-bottom: 0in">                        const
aiBestMoveInfo = getBestNewLineMoveWithCount(aiSymbol);</p>
<p style="margin-bottom: 0in">                        if
(aiBestMoveInfo &amp;&amp; aiBestMoveInfo.count &gt;= 1) return
aiBestMoveInfo.move;</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                    return
getRandomLegalMove();</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                case 'normal':</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23559;&#36557;&#32026;&#65306;&#32317;&#26159;&#22039;&#35430;&#21109;&#36896;&#21934;&#32218;&#65292;&#21542;&#21063;&#38568;&#27231;</font></span></font></p>
<p style="margin-bottom: 0in">                    const
normalAiBestMoveInfo = getBestNewLineMoveWithCount(aiSymbol);</p>
<p style="margin-bottom: 0in">                    if
(normalAiBestMoveInfo &amp;&amp; normalAiBestMoveInfo.count &gt;= 1)
return normalAiBestMoveInfo.move;</p>
<p style="margin-bottom: 0in">                    return
getRandomLegalMove();</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                case 'difficult':</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22823;&#39764;&#23566;&#24107;&#32026;&#65306;&#32317;&#26159;&#21109;&#36896;&#21934;&#32218;&#65292;&#20006;&#22039;&#35430;&#38459;&#25803;&#23565;&#25163;&#30340;&#21934;&#32218;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36629;&#24230;&#38450;&#31142;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                    const
difficultAiBestMoveInfo = getBestNewLineMoveWithCount(aiSymbol);</p>
<p style="margin-bottom: 0in">                    if
(difficultAiBestMoveInfo &amp;&amp; difficultAiBestMoveInfo.count &gt;=
1) return difficultAiBestMoveInfo.move;</p>
<p style="margin-bottom: 0in">                    
</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38459;&#25803;&#23565;&#25163;&#21109;&#36896;&#21934;&#32218;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;&#33021;&#25214;&#21040;&#65292;&#20294;&#19981;&#21109;&#36896;&#23565;&#25163;&#20998;&#21449;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                    const
difficultHumanBlockInfo = getBestNewLineMoveWithCount(humanSymbol);</p>
<p style="margin-bottom: 0in">                    if
(difficultHumanBlockInfo &amp;&amp; difficultHumanBlockInfo.count &gt;=
1) return difficultHumanBlockInfo.move;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20013;&#24515;&#20559;&#22909;</font></span></font></p>
<p style="margin-bottom: 0in">                    const
centerMoveDifficult = getCenterProximityMove();</p>
<p style="margin-bottom: 0in">                    if
(centerMoveDifficult) return centerMoveDifficult;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                    return
getRandomLegalMove();</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                case 'hell':</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
** </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26997;&#38480;&#39764;&#29579;&#32026;&#65306;&#20998;&#21449;&#25915;&#25802;</font></span></font><font face="Arial Unicode MS, serif">/</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38450;&#31142;&#33287;&#20013;&#24515;&#21270;&#31574;&#30053;
</font></span></font><font face="Arial Unicode MS, serif">(Diabolical
Fork &amp; Center Control) **</font></p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
3. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39764;&#29579;&#20998;&#21449;&#36914;&#25915;
</font></span></font><font face="Arial Unicode MS, serif">(Attack
Fork: 2+ New Lines)</font></p>
<p style="margin-bottom: 0in">                    const
hellAiBestMoveInfo = getBestNewLineMoveWithCount(aiSymbol);</p>
<p style="margin-bottom: 0in">                    if
(hellAiBestMoveInfo &amp;&amp; hellAiBestMoveInfo.count &gt;= 2) {</p>
<p style="margin-bottom: 0in">                        return
hellAiBestMoveInfo.move;</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
4. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39764;&#29579;&#20998;&#21449;&#38450;&#31142;
</font></span></font><font face="Arial Unicode MS, serif">(Block
Fork: Opponent's 2+ New Lines)</font></p>
<p style="margin-bottom: 0in">                    const
hellHumanBlockInfo = getBestNewLineMoveWithCount(humanSymbol);</p>
<p style="margin-bottom: 0in">                    if
(hellHumanBlockInfo &amp;&amp; hellHumanBlockInfo.count &gt;= 2) {</p>
<p style="margin-bottom: 0in">                        return
hellHumanBlockInfo.move;</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
5. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26368;&#22823;&#21270;&#36899;&#32218;
</font></span></font><font face="Arial Unicode MS, serif">(Max Lines:
1 New Line, preferred over random)</font></p>
<p style="margin-bottom: 0in">                    if
(hellAiBestMoveInfo &amp;&amp; hellAiBestMoveInfo.count &gt;= 1) {</p>
<p style="margin-bottom: 0in">                        return
hellAiBestMoveInfo.move; 
</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                    
</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
6. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20013;&#24515;&#20559;&#22909;
</font></span></font><font face="Arial Unicode MS, serif">(Center
Preference: Strategic positioning)</font></p>
<p style="margin-bottom: 0in">                    const
centerProximityMove = getCenterProximityMove();</p>
<p style="margin-bottom: 0in">                    if
(centerProximityMove) {</p>
<p style="margin-bottom: 0in">                        return
centerProximityMove;</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
7. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38568;&#27231;</font></span></font></p>
<p style="margin-bottom: 0in">                    return
getRandomLegalMove();</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">                default:</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38928;&#35373;&#28858;&#26222;&#36890;</font></span></font></p>
<p style="margin-bottom: 0in">                    return
getRandomLegalMove(); 
</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        // --- Game Flow &amp; Status
Updates ---</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29554;&#21462;&#29609;&#23478;
</font></span></font><font face="Arial Unicode MS, serif">1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25110;&#29609;&#23478;
</font></span></font><font face="Arial Unicode MS, serif">2 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#39023;&#31034;&#21517;&#31281;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
@param {boolean} isP1 - </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26159;&#21542;&#28858;
</font></span></font><font face="Arial Unicode MS, serif">P1</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         * @returns {string}</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
getPlayerDisplayName(isP1) {</p>
<p style="margin-bottom: 0in">            if (isP1) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
P1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#32317;&#26159;&#23431;&#23449;&#25136;&#22763;
</font></span></font><font face="Arial Unicode MS, serif">1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#34399;
</font></span></font><font face="Arial Unicode MS, serif">(PvP) </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25110;
&#25361;&#25136;&#32773; </font></span></font><font face="Arial Unicode MS, serif">(PvC)</font></p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">return
gameMode === 'PVC' ? '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23431;&#23449;&#25136;&#22763;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25361;&#25136;&#32773;</font></span></font><font face="Arial Unicode MS, serif">)'
: `</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23431;&#23449;&#25136;&#22763;
</font></span></font><font face="Arial Unicode MS, serif">1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#34399;
</font></span></font><font face="Arial Unicode MS, serif">(${currentP1Config.name})`;</font></p>
<p style="margin-bottom: 0in">            } else {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
P2 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26159;
&#39764;&#29579; </font></span></font><font face="Arial Unicode MS, serif">(PvC)
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25110;
&#23431;&#23449;&#25136;&#22763; </font></span></font><font face="Arial Unicode MS, serif">2
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#34399;
</font></span></font><font face="Arial Unicode MS, serif">(PvP)</font></p>
<p style="margin-bottom: 0in">                return gameMode ===
'PVC' ? '&#128520; <font face="Arial"><span lang="zh-CN">&#39764;&#29579;
</span></font>(<font face="Arial"><span lang="zh-CN">&#24460;&#25163;</span></font>)'
: `<font face="Arial"><span lang="zh-CN">&#23431;&#23449;&#25136;&#22763;
</span></font>2 <font face="Arial"><span lang="zh-CN">&#34399;
</span></font>(${currentP2Config.name})`;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Renders the overall match
scores in the dedicated score box.</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function renderMatchScores() {</p>
<p style="margin-bottom: 0in">            const p1Config =
currentP1Config;</p>
<p style="margin-bottom: 0in">            const p2Config =
currentP2Config;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            const p1Wins =
matchScores[p1Config.symbol] || 0;</p>
<p style="margin-bottom: 0in">            const p2Wins =
matchScores[p2Config.symbol] || 0;</p>
<p style="margin-bottom: 0in">            const draws =
matchScores.draws || 0;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">const
p1NameDisplay = gameMode === 'PVC' ? '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23431;&#23449;&#25136;&#22763;</font></span></font><font face="Arial Unicode MS, serif">'
: '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25136;&#22763;
</font></span></font><font face="Arial Unicode MS, serif">1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#34399;</font></span></font><font face="Arial Unicode MS, serif">';</font></p>
<p style="margin-bottom: 0in">            const p2NameDisplay =
gameMode === 'PVC' ? '&#128520; <font face="Arial"><span lang="zh-CN">&#39764;&#29579;</span></font>'
: '<font face="Arial"><span lang="zh-CN">&#25136;&#22763; </span></font>2
<font face="Arial"><span lang="zh-CN">&#34399;</span></font>';</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#30070;&#21069;&#27604;&#20998;&#26356;&#26032;&#36914;&#24230;&#26781;&#38991;&#33394;</font></span></font></p>
<p style="margin-bottom: 0in">            const p1ScoreColor = p1Wins
&gt;= MATCH_WINS_TO_END ? '#f6e05e' : p1Config.color;</p>
<p style="margin-bottom: 0in">            const p2ScoreColor = p2Wins
&gt;= MATCH_WINS_TO_END ? '#f6e05e' : p2Config.color;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            scoreDisplayBox.innerHTML =
`</p>
<p style="margin-bottom: 0in">                &lt;div
class=&quot;score-segment&quot;&gt;</p>
<p style="margin-bottom: 0in">                    &lt;span
class=&quot;text-xs uppercase text-gray-400
font-semibold&quot;&gt;${p1NameDisplay} (${p1Config.symbol})&lt;/span&gt;</p>
<p style="margin-bottom: 0in">                    &lt;span
class=&quot;score-value&quot; style=&quot;color:
${p1ScoreColor};&quot;&gt;${p1Wins}&lt;/span&gt;</p>
<p style="margin-bottom: 0in">                &lt;/div&gt;</p>
<p style="margin-bottom: 0in">                &lt;div
class=&quot;score-separator&quot;&gt;:&lt;/div&gt;</p>
<p style="margin-bottom: 0in">                &lt;div
class=&quot;score-segment&quot;&gt;</p>
<p style="margin-bottom: 0in">                    &lt;span
class=&quot;text-xs uppercase text-gray-400
font-semibold&quot;&gt;${p2NameDisplay} (${p2Config.symbol})&lt;/span&gt;</p>
<p style="margin-bottom: 0in">                    &lt;span
class=&quot;score-value&quot; style=&quot;color:
${p2ScoreColor};&quot;&gt;${p2Wins}&lt;/span&gt;</p>
<p style="margin-bottom: 0in">                &lt;/div&gt;</p>
<p style="margin-bottom: 0in">                &lt;div class=&quot;absolute
right-4 top-4 text-xs text-gray-500 hidden md:block&quot;&gt;</p>
<p style="margin-bottom: 0in">                    <font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24179;&#23616;&#22238;&#21512;</font></span></font><font face="Arial Unicode MS, serif">:
${draws}</font></p>
<p style="margin-bottom: 0in">                &lt;/div&gt;</p>
<p style="margin-bottom: 0in">            `;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Checks if the board is full
(a draw).</p>
<p style="margin-bottom: 0in">         * @returns {boolean}</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function checkDraw() {</p>
<p style="margin-bottom: 0in">            return
board.flat().every(cell =&gt; cell !== null);</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Handles the end of a round
due to a draw (board filled).</p>
<p style="margin-bottom: 0in">         * This preserves
currentLineCounts and immediately starts a new board/round.</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function handleDraw() {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">isGameActive
= false; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20572;&#27490;&#36938;&#25138;</font></span></font></p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
1. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26356;&#26032;&#29376;&#24907;&#65292;&#39023;&#31034;&#36899;&#32218;&#25976;&#20006;&#36890;&#30693;&#24179;&#23616;</font></span></font></p>
<p style="margin-bottom: 0in">            const p1Config =
currentP1Config;</p>
<p style="margin-bottom: 0in">            const p2Config =
currentP2Config;</p>
<p style="margin-bottom: 0in">            const p1DisplayName =
getPlayerDisplayName(true);</p>
<p style="margin-bottom: 0in">            const p2DisplayName =
getPlayerDisplayName(false);</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">matchScores.draws
= (matchScores.draws || 0) + 1; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22686;&#21152;&#24179;&#23616;&#35336;&#25976;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29992;&#26044;&#39023;&#31034;&#22238;&#21512;&#25976;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">renderMatchScores();
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26356;&#26032;&#32317;&#27604;&#20998;&#65288;&#20027;&#35201;&#26159;&#24179;&#23616;&#22238;&#21512;&#25976;&#65289;</font></span></font></p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#30070;&#21069;&#30340;&#36899;&#32218;&#36914;&#24230;</font></span></font></p>
<p style="margin-bottom: 0in">            const p1Lines =
currentLineCounts[p1Config.symbol] || 0;</p>
<p style="margin-bottom: 0in">            const p2Lines =
currentLineCounts[p2Config.symbol] || 0;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            statusElement.innerHTML = `</p>
<p style="margin-bottom: 0in">                &lt;span
class=&quot;font-extrabold text-white text-xl&quot;&gt;&#129680;
<font face="Arial"><span lang="zh-CN">&#26827;&#30436;&#24050;&#28415;&#65281;&#24179;&#23616;&#65281;</span></font>&lt;/span&gt;</p>
<p style="margin-bottom: 0in">                &lt;div
class=&quot;text-base mt-2&quot;&gt;</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">${p1Config.symbol}
(${p1DisplayName}): ${p1Lines} / ${LINES_TO_WIN} </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;
</font></span></font><font face="Arial Unicode MS, serif">| </font>
</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">${p2Config.symbol}
(${p2DisplayName}): ${p2Lines} / ${LINES_TO_WIN} </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;</font></span></font></p>
<p style="margin-bottom: 0in">                &lt;/div&gt;</p>
<p style="margin-bottom: 0in">                &lt;div class=&quot;text-sm
mt-2&quot;&gt;</p>
<p style="margin-bottom: 0in">                    <font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27491;&#22312;&#33258;&#21205;&#28310;&#20633;</font></span></font><font face="Arial Unicode MS, serif">**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#19979;&#19968;&#24373;&#26827;&#30436;</font></span></font><font face="Arial Unicode MS, serif">**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65281;</font></span></font></p>
<p style="margin-bottom: 0in">                &lt;/div&gt;</p>
<p style="margin-bottom: 0in">            `;</p>
<p style="margin-bottom: 0in">            statusElement.className =
'font-bold text-gray-400';</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
2. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#33258;&#21205;&#37325;&#32622;&#26827;&#30436;&#29376;&#24907;&#65292;&#20006;&#31561;&#24453;
</font></span></font><font face="Arial Unicode MS, serif">3 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31186;</font></span></font></p>
<p style="margin-bottom: 0in">           
setTimeout(resetBoardForNewRound, 3000);</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Handles a winning condition
by highlighting winning cells, updating scores, and preparing the
next round/match.</p>
<p style="margin-bottom: 0in">         * @param {string} winnerSymbol
- The symbol of the player who won the round.</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
handleWin(winnerSymbol) {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">isGameActive
= false; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20572;&#27490;&#36938;&#25138;</font></span></font></p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
1. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39640;&#20142;&#39023;&#31034;&#21213;&#21033;&#32218;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;&#26377;&#30340;&#35441;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">            
allRegisteredWinPaths.flat().forEach(([r, c]) =&gt; {</p>
<p style="margin-bottom: 0in">                const index = r *
BOARD_SIZE + c;</p>
<p style="margin-bottom: 0in">               
cells[index].classList.add('win');</p>
<p style="margin-bottom: 0in">            });</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
2. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26356;&#26032;&#32317;&#20998;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">            const winnerConfig =
winnerSymbol === currentP1Config.symbol ? currentP1Config :
currentP2Config;</p>
<p style="margin-bottom: 0in">            matchScores[winnerSymbol] =
(matchScores[winnerSymbol] || 0) + 1;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">renderMatchScores();
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26356;&#26032;&#32317;&#27604;&#20998;&#39023;&#31034;</font></span></font></p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            const currentWins =
matchScores[winnerSymbol];</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
3. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;&#26159;&#21542;&#36948;&#21040;&#32317;&#23565;&#27770;&#21213;&#21033;&#26781;&#20214;</font></span></font></p>
<p style="margin-bottom: 0in">            if (currentWins &gt;=
MATCH_WINS_TO_END) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31435;&#21363;&#23459;&#24067;&#26368;&#32066;&#21213;&#21033;</font></span></font></p>
<p style="margin-bottom: 0in">               
declareMatchWinner(winnerSymbol, true);</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">return;
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36864;&#20986;&#65292;&#19981;&#20877;&#22519;&#34892;&#19979;&#19968;&#22238;&#21512;&#30340;&#24310;&#36978;</font></span></font></p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
4. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#22238;&#21512;&#21213;&#21033;&#35338;&#24687;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;&#32317;&#23565;&#27770;&#26410;&#32080;&#26463;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">            let winnerNameDisplay;</p>
<p style="margin-bottom: 0in">            if (gameMode === 'PVC' &amp;&amp;
winnerSymbol === currentP2Config.symbol) {</p>
<p style="margin-bottom: 0in">                const difficultyName =
difficultySelector.options[difficultySelector.selectedIndex].text;</p>
<p style="margin-bottom: 0in">                winnerNameDisplay = `&#128520;
<font face="Arial"><span lang="zh-CN">&#39764;&#29579;&#36557;&#22296;
</span></font>(${difficultyName})`;</p>
<p style="margin-bottom: 0in">                statusElement.innerHTML
= `</p>
<p style="margin-bottom: 0in">                    &lt;span
class=&quot;font-extrabold text-2xl&quot; style=&quot;color:
${winnerConfig.color};&quot;&gt;&#128128; <font face="Arial"><span lang="zh-CN">&#34987;&#39764;&#29579;&#22890;&#36208;
</span></font>1 <font face="Arial"><span lang="zh-CN">&#20998;&#65281;&#128128;</span></font>&lt;/span&gt;</p>
<p style="margin-bottom: 0in">                    &lt;div
class=&quot;text-base mt-2&quot;&gt;</p>
<p style="margin-bottom: 0in">                       
<font face="Arial Unicode MS, serif">${winnerNameDisplay} </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24050;&#23436;&#25104;
</font></span></font><font face="Arial Unicode MS, serif">${LINES_TO_WIN}
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#36899;&#32218;&#65281;&#32317;&#20998;</font></span></font><font face="Arial Unicode MS, serif">:
${currentWins}/${MATCH_WINS_TO_END}</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#12290;&#21363;&#23559;&#38283;&#22987;&#19979;&#19968;&#22238;&#21512;</font></span></font><font face="Arial Unicode MS, serif">...</font></p>
<p style="margin-bottom: 0in">                    &lt;/div&gt;</p>
<p style="margin-bottom: 0in">                `;</p>
<p style="margin-bottom: 0in">            } else if (winnerSymbol ===
currentP1Config.symbol) {</p>
<p style="margin-bottom: 0in">                winnerNameDisplay =
getPlayerDisplayName(true);</p>
<p style="margin-bottom: 0in">                
statusElement.innerHTML = `</p>
<p style="margin-bottom: 0in">                    &lt;span
class=&quot;font-extrabold text-2xl&quot;&gt;&#127942; <font face="Arial"><span lang="zh-CN">&#24685;&#21916;
</span></font>${winnerNameDisplay} <font face="Arial"><span lang="zh-CN">&#25802;&#25943;&#39764;&#29579;&#36557;&#22296;&#65281;
&#127942;</span></font>&lt;/span&gt;</p>
<p style="margin-bottom: 0in">                    &lt;div
class=&quot;text-base mt-2&quot;&gt;</p>
<p style="margin-bottom: 0in">                        <font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24050;&#36948;&#25104;
</font></span></font><font face="Arial Unicode MS, serif">${LINES_TO_WIN}
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#36899;&#32218;&#65281;&#32317;&#20998;</font></span></font><font face="Arial Unicode MS, serif">:
${currentWins}/${MATCH_WINS_TO_END}</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#12290;&#21363;&#23559;&#33258;&#21205;&#38283;&#22987;&#19979;&#19968;&#22238;&#21512;</font></span></font><font face="Arial Unicode MS, serif">...</font></p>
<p style="margin-bottom: 0in">                    &lt;/div&gt;</p>
<p style="margin-bottom: 0in">                `;</p>
<p style="margin-bottom: 0in">            } else { // PvP Player 2
Win</p>
<p style="margin-bottom: 0in">                winnerNameDisplay =
getPlayerDisplayName(false);</p>
<p style="margin-bottom: 0in">                
statusElement.innerHTML = `</p>
<p style="margin-bottom: 0in">                    &lt;span
class=&quot;font-extrabold text-2xl&quot;&gt;&#127942; <font face="Arial"><span lang="zh-CN">&#24685;&#21916;
</span></font>${winnerNameDisplay} <font face="Arial"><span lang="zh-CN">&#29554;&#24471;&#21213;&#21033;&#65281;
&#127942;</span></font>&lt;/span&gt;</p>
<p style="margin-bottom: 0in">                    &lt;div
class=&quot;text-base mt-2&quot;&gt;</p>
<p style="margin-bottom: 0in">                        <font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24050;&#36948;&#25104;
</font></span></font><font face="Arial Unicode MS, serif">${LINES_TO_WIN}
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#36899;&#32218;&#65281;&#32317;&#20998;</font></span></font><font face="Arial Unicode MS, serif">:
${currentWins}/${MATCH_WINS_TO_END}</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#12290;&#21363;&#23559;&#33258;&#21205;&#38283;&#22987;&#19979;&#19968;&#22238;&#21512;</font></span></font><font face="Arial Unicode MS, serif">...</font></p>
<p style="margin-bottom: 0in">                    &lt;/div&gt;</p>
<p style="margin-bottom: 0in">                `;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            statusElement.className =
'font-bold text-[#f6e05e]'; 
</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
5. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#33258;&#21205;&#38283;&#22987;&#19979;&#19968;&#22238;&#21512;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20445;&#25345;&#32317;&#27604;&#20998;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">            setTimeout(() =&gt;
startNewMatch(false), 3000);</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Renders the game status
message.</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function updateStatus() {</p>
<p style="margin-bottom: 0in">            if (!isGameActive) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;&#36938;&#25138;&#32080;&#26463;&#65292;&#19981;&#35201;&#35206;&#33995;
</font></span></font><font face="Arial Unicode MS, serif">handleWin </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25110;
</font></span></font><font face="Arial Unicode MS, serif">handleDraw
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#35338;&#24687;</font></span></font></p>
<p style="margin-bottom: 0in">                return;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            const isP1Turn =
currentPlayerSymbol === currentP1Config.symbol;</p>
<p style="margin-bottom: 0in">            const currentPlayerConfig =
isP1Turn ? currentP1Config : currentP2Config;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            let turnMessage = '';</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            if (gameMode === 'PVC' &amp;&amp;
!isP1Turn) {</p>
<p style="margin-bottom: 0in">                 <font face="Arial Unicode MS, serif">//
P2 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#22238;&#21512;&#65292;&#19988;&#26159;
&#39764;&#29579; </font></span></font><font face="Arial Unicode MS, serif">AI</font></p>
<p style="margin-bottom: 0in">                const difficultyName =
difficultySelector.options[difficultySelector.selectedIndex].text;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">const
delayText = `(${AI_DELAY_MS[difficultyLevel] / 1000} </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31186;&#21453;&#25033;</font></span></font><font face="Arial Unicode MS, serif">)`;</font></p>
<p style="margin-bottom: 0in">                turnMessage = `&lt;span
class=&quot;font-extrabold&quot; style=&quot;color:
${currentPlayerConfig.color};&quot;&gt;&#128520; <font face="Arial"><span lang="zh-CN">&#39764;&#29579;&#36557;&#22296;
</span></font>(${difficultyName})&lt;/span&gt;
<font face="Arial"><span lang="zh-CN">&#27491;&#22312;&#30332;&#21205;&#25915;&#21218;</span></font>...${delayText}`;</p>
<p style="margin-bottom: 0in">                statusElement.className
= `font-bold text-lg`;</p>
<p style="margin-bottom: 0in">            } else {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20154;&#39006;&#29609;&#23478;
</font></span></font><font face="Arial Unicode MS, serif">P1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25110;
</font></span></font><font face="Arial Unicode MS, serif">PvP </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24335;</font></span></font></p>
<p style="margin-bottom: 0in">                const playerName =
getPlayerDisplayName(isP1Turn);</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">turnMessage
= `</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29694;&#22312;&#36650;&#21040;
</font></span></font><font face="Arial Unicode MS, serif">&lt;span
class=&quot;font-extrabold&quot; style=&quot;color:
${currentPlayerConfig.color};&quot;&gt;${playerName}&lt;/span&gt;
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#22238;&#21512;</font></span></font><font face="Arial Unicode MS, serif">...`;</font></p>
<p style="margin-bottom: 0in">                statusElement.className
= `font-bold text-lg`;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#30070;&#21069;&#30340;&#36899;&#32218;&#36914;&#24230;</font></span></font></p>
<p style="margin-bottom: 0in">            const p1Lines =
currentLineCounts[currentP1Config.symbol] || 0;</p>
<p style="margin-bottom: 0in">            const p2Lines =
currentLineCounts[currentP2Config.symbol] || 0;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">const
p1Label = gameMode === 'PVC' ? '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25136;&#22763;</font></span></font><font face="Arial Unicode MS, serif">'
: '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25136;&#22763;
</font></span></font><font face="Arial Unicode MS, serif">1';</font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">const
p2Label = gameMode === 'PVC' ? '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39764;&#29579;</font></span></font><font face="Arial Unicode MS, serif">'
: '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25136;&#22763;
</font></span></font><font face="Arial Unicode MS, serif">2';</font></p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            const progressDisplay = `</p>
<p style="margin-bottom: 0in">                &lt;span
class=&quot;score-progress-display text-gray-400&quot;&gt;</p>
<p style="margin-bottom: 0in">                   
<font face="Arial Unicode MS, serif">${currentP1Config.symbol}
(${p1Label}): ${p1Lines} / ${LINES_TO_WIN} </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;
</font></span></font><font face="Arial Unicode MS, serif">| </font>
</p>
<p style="margin-bottom: 0in">                   
<font face="Arial Unicode MS, serif">${currentP2Config.symbol}
(${p2Label}): ${p2Lines} / ${LINES_TO_WIN} </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;</font></span></font></p>
<p style="margin-bottom: 0in">                &lt;/span&gt;</p>
<p style="margin-bottom: 0in">            `;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            statusElement.innerHTML =
turnMessage + progressDisplay;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Handles a cell click event.</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function handleClick(index) {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38459;&#27490;&#40670;&#25802;&#65306;&#36938;&#25138;&#32080;&#26463;&#12289;&#38651;&#33126;&#22238;&#21512;</font></span></font></p>
<p style="margin-bottom: 0in">            if (!isGameActive ||
isAITurn) return; 
</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            const r = Math.floor(index
/ BOARD_SIZE);</p>
<p style="margin-bottom: 0in">            const c = index %
BOARD_SIZE;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            if (board[r][c] !== null)
return;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
1. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20154;&#39006;&#29609;&#23478;&#31227;&#21205;
</font></span></font><font face="Arial Unicode MS, serif">(P1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25110;
</font></span></font><font face="Arial Unicode MS, serif">P2, </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;
</font></span></font><font face="Arial Unicode MS, serif">currentPlayerSymbol)</font></p>
<p style="margin-bottom: 0in">            executeMove(r, c); 
</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
2. AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22238;&#21512;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;&#36938;&#25138;&#20173;&#22312;&#36914;&#34892;&#19988;&#22312;
</font></span></font><font face="Arial Unicode MS, serif">PvC </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24335;&#19979;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">            if (isGameActive &amp;&amp;
gameMode === 'PVC' &amp;&amp; currentPlayerSymbol ===
currentP2Config.symbol) {</p>
<p style="margin-bottom: 0in">                isAITurn = true;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">updateStatus();
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;
</font></span></font><font face="Arial Unicode MS, serif">AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27491;&#22312;&#24605;&#32771;</font></span></font><font face="Arial Unicode MS, serif">...</font></p>
<p style="margin-bottom: 0in">                
</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#38627;&#24230;&#35373;&#23450;
</font></span></font><font face="Arial Unicode MS, serif">AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24310;&#36978;&#26178;&#38291;</font></span></font></p>
<p style="margin-bottom: 0in">                const aiDelay =
AI_DELAY_MS[difficultyLevel] || AI_DELAY_MS['normal'];</p>
<p style="margin-bottom: 0in">                
</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#25836;&#24605;&#32771;&#26178;&#38291;</font></span></font></p>
<p style="margin-bottom: 0in">                setTimeout(() =&gt; {</p>
<p style="margin-bottom: 0in">                    if (!isGameActive)
{</p>
<p style="margin-bottom: 0in">                        isAITurn =
false; 
</p>
<p style="margin-bottom: 0in">                        return;</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                    
</p>
<p style="margin-bottom: 0in">                    const aiMove =
getComputerMove();</p>
<p style="margin-bottom: 0in">                    
</p>
<p style="margin-bottom: 0in">                    if (aiMove) {</p>
<p style="margin-bottom: 0in">                        const [aiR,
aiC] = aiMove;</p>
<p style="margin-bottom: 0in">                       
executeMove(aiR, aiC);</p>
<p style="margin-bottom: 0in">                    } else if
(checkDraw()) { 
</p>
<p style="margin-bottom: 0in">                        <font face="Arial Unicode MS, serif">handleDraw();
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20351;&#29992;&#26032;&#30340;&#24179;&#23616;&#34389;&#29702;&#20989;&#25976;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26371;&#33258;&#21205;&#37325;&#35373;&#26827;&#30436;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                    } else {</p>
<p style="margin-bottom: 0in">                        <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;
</font></span></font><font face="Arial Unicode MS, serif">AI
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27794;&#26377;&#25214;&#21040;&#31227;&#21205;&#19988;&#26827;&#30436;&#26410;&#28415;&#65292;&#20294;&#36938;&#25138;&#36996;&#27794;&#32080;&#26463;&#65292;&#32380;&#32396;&#20999;&#25563;&#22238;&#21512;</font></span></font></p>
<p style="margin-bottom: 0in">                       
currentPlayerSymbol = currentPlayerSymbol === currentP1Config.symbol 
</p>
<p style="margin-bottom: 0in">                                    ?
currentP2Config.symbol 
</p>
<p style="margin-bottom: 0in">                                    :
currentP1Config.symbol;</p>
<p style="margin-bottom: 0in">                    }</p>
<p style="margin-bottom: 0in">                    
</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">isAITurn
= false; // AI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22238;&#21512;&#32080;&#26463;</font></span></font></p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">updateStatus();
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#19979;&#19968;&#20301;&#29609;&#23478;&#65288;</font></span></font><font face="Arial Unicode MS, serif">P1</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65289;</font></span></font></p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">},
aiDelay); // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20351;&#29992;&#21205;&#24907;&#24310;&#36978;&#26178;&#38291;</font></span></font></p>
<p style="margin-bottom: 0in">            } else {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
PvP </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24335;&#65292;&#20999;&#25563;&#21040;&#19979;&#19968;&#20301;&#29609;&#23478;</font></span></font></p>
<p style="margin-bottom: 0in">                updateStatus();</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Initializes the game board
structure in the DOM.</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function createBoard() {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">boardElement.innerHTML
= ''; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#28165;&#38500;&#33290;&#26827;&#30436;</font></span></font></p>
<p style="margin-bottom: 0in">            cells = [];</p>
<p style="margin-bottom: 0in">            for (let i = 0; i &lt;
BOARD_SIZE * BOARD_SIZE; i++) {</p>
<p style="margin-bottom: 0in">                const cell =
document.createElement('div');</p>
<p style="margin-bottom: 0in">               
cell.classList.add('cell');</p>
<p style="margin-bottom: 0in">                cell.dataset.index = i;</p>
<p style="margin-bottom: 0in">               
cell.addEventListener('click', () =&gt; handleClick(i));</p>
<p style="margin-bottom: 0in">               
boardElement.appendChild(cell);</p>
<p style="margin-bottom: 0in">                cells.push(cell);</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35731;
</font></span></font><font face="Arial Unicode MS, serif">CSS Grid
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#33258;&#21205;&#35519;&#25972;&#22823;&#23567;&#20197;&#36969;&#25033;&#23481;&#22120;</font></span></font></p>
<p style="margin-bottom: 0in">           
boardElement.style.gridTemplateColumns = `repeat(${BOARD_SIZE},
1fr)`;</p>
<p style="margin-bottom: 0in">           
boardElement.style.gridTemplateRows = `repeat(${BOARD_SIZE}, 1fr)`;</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Resets the board state
(board array, win paths, visuals). 
</p>
<p style="margin-bottom: 0in">         * Preserves matchScores. Used
for a Draw (next round) or starting a new match.</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
resetBoardForNewRound() {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
1. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37325;&#32622;&#36938;&#25138;&#25976;&#25818;</font></span></font></p>
<p style="margin-bottom: 0in">            board =
Array(BOARD_SIZE).fill(null).map(() =&gt;
Array(BOARD_SIZE).fill(null));</p>
<p style="margin-bottom: 0in">            isGameActive = true;</p>
<p style="margin-bottom: 0in">            isAITurn = false; 
</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
2. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37325;&#32622;&#21934;&#19968;&#26827;&#30436;&#19978;&#30340;&#29554;&#21213;&#36861;&#36452;</font></span></font></p>
<p style="margin-bottom: 0in">            allRegisteredWinPaths = [];</p>
<p style="margin-bottom: 0in">            registeredWinIds = new
Set(); 
</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
3. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37325;&#32622;&#29609;&#23478;&#31526;&#34399;&#21040;
</font></span></font><font face="Arial Unicode MS, serif">P1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#36984;&#25799;</font></span></font></p>
<p style="margin-bottom: 0in">            currentPlayerSymbol =
currentP1Config.symbol;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
4. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37325;&#32622;&#26827;&#30436;&#35222;&#35258;&#25928;&#26524;</font></span></font></p>
<p style="margin-bottom: 0in">            cells.forEach(cell =&gt; {</p>
<p style="margin-bottom: 0in">                cell.textContent = '';</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31227;&#38500;&#25152;&#26377;&#31526;&#34399;&#21644;&#21213;&#21033;&#39006;&#21517;</font></span></font></p>
<p style="margin-bottom: 0in">               
Object.values(PIECES).forEach(piece =&gt; {</p>
<p style="margin-bottom: 0in">                   
cell.classList.remove(piece.class);</p>
<p style="margin-bottom: 0in">                });</p>
<p style="margin-bottom: 0in">               
cell.classList.remove('win', 'pop-effect'); 
</p>
<p style="margin-bottom: 0in">                cell.style.cursor =
'pointer';</p>
<p style="margin-bottom: 0in">            });</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
5. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26356;&#26032;&#29376;&#24907;</font></span></font></p>
<p style="margin-bottom: 0in">            updateStatus();</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        <font face="Arial Unicode MS, serif">//
--- </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27169;&#24907;&#26694;&#30456;&#38364;&#21151;&#33021;
</font></span></font><font face="Arial Unicode MS, serif">---</font></p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#24950;&#31069;&#27169;&#24907;&#26694;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
showCelebrationModal(title, message, color) {</p>
<p style="margin-bottom: 0in">            modalTitle.innerHTML =
`&lt;span class=&quot;animate-pulse&quot;&gt;${title}&lt;/span&gt;`;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">modalTitle.style.color
= color; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20351;&#29992;&#21213;&#21033;&#32773;&#30340;&#38991;&#33394;</font></span></font></p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35373;&#32622;&#27169;&#24907;&#26694;&#37002;&#26694;&#38991;&#33394;</font></span></font></p>
<p style="margin-bottom: 0in">           
modalContent.style.borderColor = color;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">modalTitle.style.textShadow
= `0 0 10px ${color}, 0 0 20px ${color}80`; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22686;&#21152;&#38675;&#34425;&#30332;&#20809;&#25928;&#26524;</font></span></font></p>
<p style="margin-bottom: 0in">            modalMessage.textContent =
message;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#27169;&#24907;&#26694;&#20006;&#35320;&#30332;
</font></span></font><font face="Arial Unicode MS, serif">CSS </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36681;&#25563;</font></span></font></p>
<p style="margin-bottom: 0in">           
celebrationModal.classList.remove('hidden');</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20351;&#29992;
</font></span></font><font face="Arial Unicode MS, serif">requestAnimationFrame
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30906;&#20445;&#22312;&#28155;&#21152;
</font></span></font><font face="Arial Unicode MS, serif">class
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20043;&#21069;&#20803;&#32032;&#24050;&#32147;&#28210;&#26579;&#65292;&#20197;&#20415;&#36681;&#25563;&#29983;&#25928;</font></span></font></p>
<p style="margin-bottom: 0in">            requestAnimationFrame(() =&gt;
{</p>
<p style="margin-bottom: 0in">               
celebrationModal.classList.add('modal-show');</p>
<p style="margin-bottom: 0in">            });</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38577;&#34255;&#24950;&#31069;&#27169;&#24907;&#26694;&#65292;&#20006;&#22519;&#34892;&#23436;&#20840;&#37325;&#32622;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
@param {boolean} [forceReset=false] - </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26159;&#21542;&#24375;&#21046;&#22519;&#34892;&#32317;&#27604;&#20998;&#27512;&#38646;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
hideCelebrationModal(forceReset = false) {</p>
<p style="margin-bottom: 0in">           
celebrationModal.classList.remove('modal-show');</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24310;&#36978;&#38577;&#34255;&#65292;&#35731;&#36681;&#25563;&#23436;&#25104;</font></span></font></p>
<p style="margin-bottom: 0in">            setTimeout(() =&gt; {</p>
<p style="margin-bottom: 0in">               
celebrationModal.classList.add('hidden');</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22519;&#34892;&#23436;&#20840;&#37325;&#32622;&#65292;&#38283;&#22987;&#26032;&#23616;&#65288;&#26371;&#35320;&#30332;
</font></span></font><font face="Arial Unicode MS, serif">forceScoreWipe
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37007;&#36655;&#65289;</font></span></font></p>
<p style="margin-bottom: 0in">                if (forceReset) {</p>
<p style="margin-bottom: 0in">                    startNewMatch(true,
true); 
</p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">},
500); // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#33287;
</font></span></font><font face="Arial Unicode MS, serif">CSS </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36681;&#25563;&#26178;&#38291;&#21305;&#37197;</font></span></font></p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23459;&#21578;&#26412;&#22580;&#23565;&#27770;&#30340;&#26368;&#32066;&#21213;&#21033;&#32773;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22522;&#26044;&#32317;&#27604;&#20998;&#25110;&#22238;&#21512;&#32066;&#32080;</font></span></font><font face="Arial Unicode MS, serif">)</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
@param {string | null} winnerSymbol - </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26368;&#32066;&#21213;&#21033;&#32773;&#30340;&#31526;&#34399;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;&#28858;
</font></span></font><font face="Arial Unicode MS, serif">null</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65292;&#21063;&#30001;&#20998;&#25976;&#27604;&#36611;&#27770;&#23450;</font></span></font><font face="Arial Unicode MS, serif">)</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         <font face="Arial Unicode MS, serif">*
@param {boolean} isFinalWin - </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26159;&#21542;&#28858;&#22238;&#21512;&#32080;&#26463;&#24460;&#30340;&#30452;&#25509;&#29554;&#21213;&#12290;</font></span></font></p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
declareMatchWinner(winnerSymbol = null, isFinalWin = false) {</p>
<p style="margin-bottom: 0in">            const p1Symbol =
currentP1Config.symbol;</p>
<p style="margin-bottom: 0in">            const p2Symbol =
currentP2Config.symbol;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            const p1Wins =
matchScores[p1Symbol] || 0;</p>
<p style="margin-bottom: 0in">            const p2Wins =
matchScores[p2Symbol] || 0;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            let finalTitle = '';</p>
<p style="margin-bottom: 0in">            let finalMessage = '';</p>
<p style="margin-bottom: 0in">            let titleColor = '#f6e05e';</p>
<p style="margin-bottom: 0in">            let winnerConfig = null;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">const
p1DisplayName = gameMode === 'PVC' ? '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23431;&#23449;&#25136;&#22763;</font></span></font><font face="Arial Unicode MS, serif">'
: '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23431;&#23449;&#25136;&#22763;
</font></span></font><font face="Arial Unicode MS, serif">1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#34399;</font></span></font><font face="Arial Unicode MS, serif">';</font></p>
<p style="margin-bottom: 0in">            const p2DisplayName =
gameMode === 'PVC' ? '&#128520; <font face="Arial"><span lang="zh-CN">&#26997;&#38480;&#39764;&#29579;</span></font>'
: '<font face="Arial"><span lang="zh-CN">&#23431;&#23449;&#25136;&#22763;
</span></font>2 <font face="Arial"><span lang="zh-CN">&#34399;</span></font>';</p>
<p style="margin-bottom: 0in">            const difficultyName =
difficultySelector.options[difficultySelector.selectedIndex].text;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            // Determine Winner/Draw</p>
<p style="margin-bottom: 0in">            if (winnerSymbol) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30906;&#23450;&#21213;&#21033;&#32773;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24478;
</font></span></font><font face="Arial Unicode MS, serif">handleWin
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20659;&#20837;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                winnerConfig =
PIECES[winnerSymbol === p1Symbol ? currentP1Key : currentP2Key];</p>
<p style="margin-bottom: 0in">            } else {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36879;&#36942;&#20998;&#25976;&#27604;&#36611;&#27770;&#23450;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24478;
</font></span></font><font face="Arial Unicode MS, serif">reset-button
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#35320;&#30332;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                if (p1Wins &gt; p2Wins)
{ winnerConfig = currentP1Config; winnerSymbol = p1Symbol; } 
</p>
<p style="margin-bottom: 0in">                else if (p2Wins &gt;
p1Wins) { winnerConfig = currentP2Config; winnerSymbol = p2Symbol; }</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            if (winnerSymbol ===
p1Symbol) {</p>
<p style="margin-bottom: 0in">                finalTitle = `&#128081;
${p1DisplayName} <font face="Arial"><span lang="zh-CN">&#20977;&#26059;&#65281;</span></font>`;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">finalMessage
= `</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25104;&#21151;&#25802;&#25943;&#39764;&#29579;&#36557;&#22296;&#65281;&#26368;&#32066;&#27604;&#20998;&#65306;</font></span></font><font face="Arial Unicode MS, serif">${p1Wins}
- ${p2Wins}</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#12290;&#20320;&#35657;&#26126;&#20102;&#33258;&#24049;&#26159;&#37504;&#27827;&#31995;&#26368;&#24375;&#22823;&#30340;&#25136;&#22763;&#65281;</font></span></font><font face="Arial Unicode MS, serif">`;</font></p>
<p style="margin-bottom: 0in">                titleColor =
winnerConfig.color;</p>
<p style="margin-bottom: 0in">            } else if (winnerSymbol ===
p2Symbol) {</p>
<p style="margin-bottom: 0in">                const winnerName =
(gameMode === 'PVC') ? `&#128520; <font face="Arial"><span lang="zh-CN">&#26997;&#38480;&#39764;&#29579;
</span></font>(${difficultyName})` : p2DisplayName;</p>
<p style="margin-bottom: 0in">                finalTitle = `&#128128;
<font face="Arial"><span lang="zh-CN">&#25361;&#25136;&#22833;&#25943;&#65281;&#39764;&#29579;&#36557;&#22296;&#31281;&#38712;&#65281;</span></font>`;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">finalMessage
= `${winnerName} </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20197;
</font></span></font><font face="Arial Unicode MS, serif">${p2Wins} -
${p1Wins} </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36111;&#24471;&#26412;&#22580;&#25136;&#24441;&#12290;&#35352;&#20303;&#65292;&#21482;&#26377;&#19981;&#26039;&#25361;&#25136;&#25165;&#33021;&#36111;&#24471;&#21213;&#21033;&#65281;</font></span></font><font face="Arial Unicode MS, serif">`;</font></p>
<p style="margin-bottom: 0in">                titleColor =
winnerConfig.color;</p>
<p style="margin-bottom: 0in">            } else {</p>
<p style="margin-bottom: 0in">                finalTitle = `&#129309;
<font face="Arial"><span lang="zh-CN">&#21490;&#35433;&#32026;&#24179;&#23616;&#65281;</span></font>`;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">finalMessage
= `</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38617;&#26041;&#32317;&#27604;&#20998;&#65306;</font></span></font><font face="Arial Unicode MS, serif">${p1Wins}
- ${p2Wins}</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65292;&#38627;&#20998;&#21213;&#36000;&#65281;&#20320;&#20497;&#30340;&#21147;&#37327;&#19981;&#30456;&#19978;&#19979;&#65281;</font></span></font><font face="Arial Unicode MS, serif">`;</font></p>
<p style="margin-bottom: 0in">                titleColor = '#ff8c00';
// Neon orange for epic draw</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
1. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20572;&#27490;&#36938;&#25138;&#27963;&#21205;&#20006;&#28165;&#38500;&#29376;&#24907;&#27396;&#30340;&#33290;&#35338;&#24687;</font></span></font></p>
<p style="margin-bottom: 0in">            isGameActive = false;</p>
<p style="margin-bottom: 0in">            statusElement.innerHTML =
'';</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
2. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#24950;&#31069;&#27169;&#24907;&#26694;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36889;&#23559;&#25509;&#31649;&#24460;&#32396;&#30340;&#37325;&#32622;&#27969;&#31243;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">           
showCelebrationModal(finalTitle, finalMessage, titleColor);</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Resets the entire match
state, including all scores and line counts.</p>
<p style="margin-bottom: 0in">         * @param {boolean}
[fullResetScores=false] - If true, initiates the match reset process.</p>
<p style="margin-bottom: 0in">         * @param {boolean}
[forceScoreWipe=false] - Internal flag: if true, performs the actual
score wipe immediately.</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function
startNewMatch(fullResetScores = false, forceScoreWipe = false) {</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
1. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26356;&#26032;&#20027;&#38988;&#37197;&#32622;&#65288;&#20006;&#34389;&#29702;
</font></span></font><font face="Arial Unicode MS, serif">PvP/PvC
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30340;&#31526;&#34399;&#34909;&#31361;&#21644;
</font></span></font><font face="Arial Unicode MS, serif">UI </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37782;&#23450;&#65289;</font></span></font></p>
<p style="margin-bottom: 0in">            updateThemeConfig();</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            const p1Symbol =
currentP1Config.symbol;</p>
<p style="margin-bottom: 0in">            const p2Symbol =
currentP2Config.symbol;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            if (fullResetScores &amp;&amp;
!forceScoreWipe) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29992;&#25142;&#40670;&#25802;
</font></span></font><font face="Arial Unicode MS, serif">&quot;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23436;&#20840;&#37325;&#32622;</font></span></font><font face="Arial Unicode MS, serif">&quot;</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#65292;&#19988;&#23578;&#26410;&#23459;&#24067;&#26368;&#32066;&#21213;&#32773;&#26178;</font></span></font></p>
<p style="margin-bottom: 0in">                const p1Wins =
matchScores[p1Symbol] || 0;</p>
<p style="margin-bottom: 0in">                const p2Wins =
matchScores[p2Symbol] || 0;</p>
<p style="margin-bottom: 0in">                
</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21482;&#26377;&#30070;&#27604;&#20998;&#19981;&#28858;&#38646;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25110;&#26377;&#24179;&#23616;&#35352;&#37636;</font></span></font><font face="Arial Unicode MS, serif">)
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25165;&#23459;&#24067;&#26368;&#32066;&#21213;&#32773;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36879;&#36942;&#27169;&#24907;&#26694;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                if (p1Wins &gt; 0 ||
p2Wins &gt; 0 || ((matchScores.draws || 0) &gt; 0 &amp;&amp;
isGameActive)) {</p>
<p style="margin-bottom: 0in">                   
declareMatchWinner(null, false);</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">return;
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36864;&#20986;&#65292;&#31561;&#24453;&#27169;&#24907;&#26694;&#25353;&#37397;&#35320;&#30332;&#26368;&#32066;&#37325;&#32622;</font></span></font></p>
<p style="margin-bottom: 0in">                }</p>
<p style="margin-bottom: 0in">            } 
</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
--- </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23526;&#38555;&#37325;&#32622;</font></span></font><font face="Arial Unicode MS, serif">/</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21021;&#22987;&#21270;&#37007;&#36655;
</font></span></font><font face="Arial Unicode MS, serif">---</font></p>
<p style="margin-bottom: 0in">            if (fullResetScores ||
forceScoreWipe) {</p>
<p style="margin-bottom: 0in">                 <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22519;&#34892;&#32317;&#27604;&#20998;&#27512;&#38646;</font></span></font></p>
<p style="margin-bottom: 0in">                 matchScores = { 
</p>
<p style="margin-bottom: 0in">                    [p1Symbol]: 0, 
</p>
<p style="margin-bottom: 0in">                    [p2Symbol]: 0, 
</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">draws:
0 // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29992;&#26044;&#36861;&#36452;&#32047;&#31309;&#30340;&#24179;&#23616;&#22238;&#21512;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">                };</p>
<p style="margin-bottom: 0in">            } else if
(!matchScores[p1Symbol] || !matchScores[p2Symbol]) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#30906;&#20445;&#20998;&#25976;&#32080;&#27083;&#23384;&#22312;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#31532;&#19968;&#27425;&#36939;&#34892;&#25110;&#20027;&#38988;&#35722;&#26356;&#26178;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                matchScores = { 
</p>
<p style="margin-bottom: 0in">                    [p1Symbol]:
matchScores[p1Symbol] || 0, 
</p>
<p style="margin-bottom: 0in">                    [p2Symbol]:
matchScores[p2Symbol] || 0, 
</p>
<p style="margin-bottom: 0in">                    draws:
matchScores.draws || 0</p>
<p style="margin-bottom: 0in">                };</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
3. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#23436;&#25972;&#37325;&#32622;&#21934;&#19968;&#26827;&#30436;&#19978;&#30340;&#36899;&#32218;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">            currentLineCounts = { 
</p>
<p style="margin-bottom: 0in">                [p1Symbol]: 0, 
</p>
<p style="margin-bottom: 0in">                [p2Symbol]: 0</p>
<p style="margin-bottom: 0in">            };</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
4. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26356;&#26032;&#32317;&#27604;&#20998;&#39023;&#31034;</font></span></font></p>
<p style="margin-bottom: 0in">            renderMatchScores();</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
5. </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#37325;&#32622;&#26827;&#30436;&#29376;&#24907;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#33258;&#21205;&#26356;&#26032;
</font></span></font><font face="Arial Unicode MS, serif">status)</font></p>
<p style="margin-bottom: 0in">            resetBoardForNewRound();</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        /**</p>
<p style="margin-bottom: 0in">         * Handles the immediate end of
the current round.</p>
<p style="margin-bottom: 0in">         * The player with the most
lines wins 1 point for the match. If tied, it's a draw.</p>
<p style="margin-bottom: 0in">         */</p>
<p style="margin-bottom: 0in">        function endRoundImmediately()
{</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22312;&#20989;&#24335;&#38283;&#38957;&#20877;&#27425;&#27298;&#26597;&#25353;&#37397;&#26159;&#21542;&#34987;&#31105;&#29992;&#65292;&#25552;&#20379;&#38617;&#37325;&#20445;&#38570;</font></span></font></p>
<p style="margin-bottom: 0in">            if
(endRoundButton.disabled) {</p>
<p style="margin-bottom: 0in">               
showTemporaryMessage('&#128683; <font face="Arial"><span lang="zh-CN">&#39764;&#29579;&#25361;&#25136;&#20013;&#65306;&#31105;&#27490;&#25552;&#21069;&#32080;&#31639;&#65281;</span></font>',
'text-red-400');</p>
<p style="margin-bottom: 0in">                return;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            if (!isGameActive) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#22914;&#26524;&#36938;&#25138;&#24050;&#32147;&#32080;&#26463;&#25110;&#24179;&#23616;&#65292;&#21063;&#30452;&#25509;&#38283;&#22987;&#26032;&#22238;&#21512;</font></span></font></p>
<p style="margin-bottom: 0in">               
resetBoardForNewRound();</p>
<p style="margin-bottom: 0in">                return;</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">isGameActive
= false; // </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20572;&#27490;&#36938;&#25138;&#65292;&#36991;&#20813;&#26356;&#22810;&#40670;&#25802;</font></span></font></p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            const p1Lines =
currentLineCounts[currentP1Config.symbol] || 0;</p>
<p style="margin-bottom: 0in">            const p2Lines =
currentLineCounts[currentP2Config.symbol] || 0;</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            let resultMessage = '';</p>
<p style="margin-bottom: 0in">            let winnerSymbol = null;</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">let
winnerNameDisplay = '</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24179;&#23616;</font></span></font><font face="Arial Unicode MS, serif">';</font></p>
<p style="margin-bottom: 0in">            let colorClass =
'text-gray-400';</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26681;&#25818;&#36899;&#32218;&#25976;&#27770;&#23450;&#22238;&#21512;&#21213;&#32773;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21363;&#20351;&#37117;&#28858;&#38646;&#20998;&#65292;&#32218;&#22810;&#32773;&#21213;&#65292;&#24179;&#25163;&#21063;&#24179;&#23616;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">            if (p1Lines &gt; p2Lines) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
P1 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29554;&#21213;</font></span></font></p>
<p style="margin-bottom: 0in">                winnerSymbol =
currentP1Config.symbol;</p>
<p style="margin-bottom: 0in">               
matchScores[winnerSymbol] = (matchScores[winnerSymbol] || 0) + 1;</p>
<p style="margin-bottom: 0in">                winnerNameDisplay =
getPlayerDisplayName(true);</p>
<p style="margin-bottom: 0in">                colorClass =
'text-[#f6e05e]';</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">resultMessage
= `${winnerNameDisplay} </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20197;
</font></span></font><font face="Arial Unicode MS, serif">${p1Lines}
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;&#21213;&#20986;&#65281;</font></span></font><font face="Arial Unicode MS, serif">`;</font></p>
<p style="margin-bottom: 0in">            } else if (p2Lines &gt;
p1Lines) {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
P2 </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#29554;&#21213;</font></span></font></p>
<p style="margin-bottom: 0in">                winnerSymbol =
currentP2Config.symbol;</p>
<p style="margin-bottom: 0in">               
matchScores[winnerSymbol] = (matchScores[winnerSymbol] || 0) + 1;</p>
<p style="margin-bottom: 0in">                winnerNameDisplay =
getPlayerDisplayName(false);</p>
<p style="margin-bottom: 0in">                colorClass =
'text-[#f6e05e]';</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">resultMessage
= `${winnerNameDisplay} </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#20197;
</font></span></font><font face="Arial Unicode MS, serif">${p2Lines}
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;&#21213;&#20986;&#65281;</font></span></font><font face="Arial Unicode MS, serif">`;</font></p>
<p style="margin-bottom: 0in">            } else {</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24179;&#23616;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21253;&#21547;
</font></span></font><font face="Arial Unicode MS, serif">0-0
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#32218;&#25976;&#24179;&#23616;&#30340;&#24773;&#27841;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">                matchScores.draws =
(matchScores.draws || 0) + 1;</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">resultMessage
= `</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#38617;&#26041;&#20197;
</font></span></font><font face="Arial Unicode MS, serif">${p1Lines}
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26781;&#32218;&#24179;&#23616;&#32080;&#26463;&#65281;</font></span></font><font face="Arial Unicode MS, serif">`;</font></p>
<p style="margin-bottom: 0in">                colorClass =
'text-white';</p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#26356;&#26032;&#32317;&#27604;&#20998;&#39023;&#31034;</font></span></font></p>
<p style="margin-bottom: 0in">            renderMatchScores();</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27298;&#26597;&#26159;&#21542;&#36948;&#21040;&#32317;&#23565;&#27770;&#21213;&#21033;&#26781;&#20214;
</font></span></font><font face="Arial Unicode MS, serif">(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21363;&#20351;&#26159;&#25552;&#21069;&#32080;&#31639;&#65292;&#20063;&#21487;&#33021;&#35320;&#30332;&#26368;&#32066;&#21213;&#21033;</font></span></font><font face="Arial Unicode MS, serif">)</font></p>
<p style="margin-bottom: 0in">            if (winnerSymbol &amp;&amp;
(matchScores[winnerSymbol] || 0) &gt;= MATCH_WINS_TO_END) {</p>
<p style="margin-bottom: 0in">               
declareMatchWinner(winnerSymbol, true);</p>
<p style="margin-bottom: 0in">                <font face="Arial Unicode MS, serif">return;
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#36864;&#20986;&#65292;&#19981;&#20877;&#22519;&#34892;&#19979;&#19968;&#22238;&#21512;&#30340;&#24310;&#36978;</font></span></font></p>
<p style="margin-bottom: 0in">            }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39023;&#31034;&#32080;&#31639;&#35338;&#24687;</font></span></font></p>
<p style="margin-bottom: 0in">            statusElement.innerHTML = `</p>
<p style="margin-bottom: 0in">                &lt;span
class=&quot;font-extrabold text-2xl&quot; style=&quot;color:
${colorClass};&quot;&gt;</p>
<p style="margin-bottom: 0in">                    ${winnerSymbol ?
'&#127941; <font face="Arial"><span lang="zh-CN">&#25552;&#21069;&#32080;&#31639;&#65281;</span></font>'
: '&#129309; <font face="Arial"><span lang="zh-CN">&#25552;&#21069;&#24179;&#23616;&#65281;</span></font>'}</p>
<p style="margin-bottom: 0in">                &lt;/span&gt;</p>
<p style="margin-bottom: 0in">                &lt;div
class=&quot;text-base mt-2&quot;&gt;</p>
<p style="margin-bottom: 0in">                    <font face="Arial Unicode MS, serif">${resultMessage}
(</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#32317;&#27604;&#20998;
</font></span></font><font face="Arial Unicode MS, serif">+1)</font></p>
<p style="margin-bottom: 0in">                &lt;/div&gt;</p>
<p style="margin-bottom: 0in">                &lt;div class=&quot;text-sm
mt-2&quot;&gt;</p>
<p style="margin-bottom: 0in">                    <font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#27491;&#22312;&#33258;&#21205;&#28310;&#20633;</font></span></font><font face="Arial Unicode MS, serif">**</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#19979;&#19968;&#22238;&#21512;</font></span></font><font face="Arial Unicode MS, serif">**...</font></p>
<p style="margin-bottom: 0in">                &lt;/div&gt;</p>
<p style="margin-bottom: 0in">            `;</p>
<p style="margin-bottom: 0in">            statusElement.className =
'font-bold';</p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#24310;&#36978;&#38283;&#22987;&#26032;&#22238;&#21512;</font></span></font></p>
<p style="margin-bottom: 0in">            setTimeout(() =&gt;
startNewMatch(false), 3000);</p>
<p style="margin-bottom: 0in">        }</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">        // --- Initialization ---</p>
<p style="margin-bottom: 0in">        
</p>
<p style="margin-bottom: 0in">        window.onload = function() {</p>
<p style="margin-bottom: 0in">            createBoard(); 
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">initThemeSelectors();
// </font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#21021;&#22987;&#21270;&#36984;&#25799;&#22120;&#21644;&#27169;&#24335;&#36984;&#25799;&#22120;</font></span></font></p>
<p style="margin-bottom: 0in">            
</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#25353;&#37397;&#29694;&#22312;&#26371;&#35320;&#30332;
</font></span></font><font face="Arial Unicode MS, serif">declareMatchWinner</font></p>
<p style="margin-bottom: 0in">           
resetButton.addEventListener('click', () =&gt; startNewMatch(true)); 
</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">            <font face="Arial Unicode MS, serif">//
</font><font face="Arial"><span lang="zh-CN"><font face="Arial Unicode MS">&#39318;&#27425;&#21152;&#36617;&#65292;&#23436;&#20840;&#37325;&#32622;&#20998;&#25976;</font></span></font></p>
<p style="margin-bottom: 0in">            startNewMatch(true); 
</p>
<p style="margin-bottom: 0in">        };</p>
<p style="margin-bottom: 0in">    &lt;/script&gt;</p>
<p style="margin-bottom: 0in"><br/>

</p>
<p style="margin-bottom: 0in">&lt;/body&gt;</p>
<p style="margin-bottom: 0in">&lt;/html&gt;</p>
<p style="margin-bottom: 0in"><br/>

</p>
</body>
</html> 9x9game
